{
  "updatedAt": "2025-11-26T01:40:46.783Z",
  "createdAt": "2025-09-03T16:29:55.866Z",
  "id": "g5d0g7VUIM87J3X8",
  "name": "IG & FB è‡ªå‹•ç™¼æ–‡",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpRequestMethod": "POST",
        "graphApiVersion": "v22.0",
        "node": "me",
        "edge": "photos",
        "sendBinaryData": true,
        "binaryPropertyName": "data",
        "options": {
          "queryParameters": {
            "parameter": [
              {
                "name": "message",
                "value": "={{ $('Get row(s)').item.json.content }}"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.facebookGraphApi",
      "typeVersion": 1,
      "position": [
        -496,
        128
      ],
      "id": "93c0c483-a1e9-4acf-9169-4aca700c0d55",
      "name": "Facebook Graph API",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "jsCode": "// å–å¾— binary keyï¼ˆé€šå¸¸æ˜¯ 'data'ï¼Œä½ å¯ä»¥æ ¹æ“šå¯¦éš›æƒ…æ³ä¿®æ”¹ï¼‰\nconst binaryKey = Object.keys(items[0].binary)[0];\n\n// å–å¾—åŸå§‹å‰¯æª”åï¼ˆä¾‹å¦‚ 'png'ï¼‰\nconst originalFileName = items[0].binary[binaryKey].fileName || 'image.png';\nconst extension = originalFileName.split('.').pop();\n\n// è‡ªè¨‚ UUID ç”¢ç”Ÿå™¨ï¼ˆä¸ä½¿ç”¨ cryptoï¼‰\nfunction generateUUID() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    const r = Math.random() * 16 | 0;\n    const v = c === 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n// ç”¢ç”Ÿæ–°æª”å\nconst newFileName = `${generateUUID()}.${extension}`;\n\n// è¼¸å‡ºçµæœ\nreturn [\n  {\n    binary: items[0].binary,\n    json: {\n      fileName: newFileName,\n    },\n  },\n];\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -496,
        288
      ],
      "id": "7c35fb76-792f-4fa2-8729-e955826d172a",
      "name": "Code2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c139da82-facd-443b-a937-6cf616169474",
              "name": "imageUrl",
              "value": "=https://naftwmajxuoauokuwpaz.supabase.co/storage/v1/object/public/ig&fb/{{ $('Code2').item.json.fileName }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -48,
        288
      ],
      "id": "dc2cec3c-d0a5-4efb-9df2-0586831aae35",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://naftwmajxuoauokuwpaz.supabase.co/storage/v1/object/ig&fb/{{ $json.fileName }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "supabaseApi",
        "sendBody": true,
        "contentType": "binaryData",
        "inputDataFieldName": "data",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        288
      ],
      "id": "95d4bca2-8047-419b-a40f-19cda6f5b350",
      "name": "supabase",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://graph.instagram.com/v23.0/17841474842780024/media",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "media_type",
              "value": "IMAGE"
            },
            {
              "name": "image_url",
              "value": "={{ $('Edit Fields').item.json.imageUrl }}"
            },
            {
              "name": "caption",
              "value": "={{ $('Get row(s)').item.json.content }}"
            },
            {
              "name": "access_token",
              "value": "={{ $json.token }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        400,
        288
      ],
      "id": "1281fe38-19ff-48de-906a-6169a367de8a",
      "name": "HTTP Request2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://graph.instagram.com/v23.0/17841474842780024/media_publish",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $('Get row(s) in sheet').item.json.token }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "creation_id",
              "value": "={{ $json.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        848,
        288
      ],
      "id": "e46ffd43-aedf-4679-abc9-5bc404f2b3c1",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1N2VDbZHjGZbTiT_qyXIAJjLw0pn5B-fOyxVIsoZXl9E",
          "mode": "list",
          "cachedResultName": "Nick_n8n_demo ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1N2VDbZHjGZbTiT_qyXIAJjLw0pn5B-fOyxVIsoZXl9E/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1778932180,
          "mode": "list",
          "cachedResultName": "è‡ªå‹•æ›´æ–°æ¬Šæ–",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1N2VDbZHjGZbTiT_qyXIAJjLw0pn5B-fOyxVIsoZXl9E/edit#gid=1778932180"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "platform",
              "lookupValue": "instagram"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        176,
        288
      ],
      "id": "45cedd8e-15be-44f8-bd96-349cdddf7584",
      "name": "Get row(s) in sheet",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/broadcast",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"messages\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"FB å·²ç™¼å¸ƒ è«‹æŸ¥çœ‹ https://www.facebook.com/photo?fbid={{ $json.id }}&set=a.122143481972920216\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        128
      ],
      "id": "30b76bee-bd31-41fd-9f30-809eb16401a4",
      "name": "ç™¼é€å›æ‡‰çµ¦ LINE",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/broadcast",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"messages\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"IG å·²ç™¼å¸ƒ è«‹æŸ¥çœ‹ {{ $json.permalink }}\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1296,
        288
      ],
      "id": "bac7ab44-dabf-43f2-aa83-622ecde1fee4",
      "name": "ç™¼é€å›æ‡‰çµ¦ LINE1",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "url": "=https://graph.instagram.com/{{ $json.id }}?fields=permalink,shortcode&access_token={{ $('Get row(s) in sheet').item.json.token }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1072,
        288
      ],
      "id": "00d34bf5-60b0-48d8-af6d-1090a0f0b987",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -1160,
        -8
      ],
      "id": "c9335abc-7943-4fed-ac40-b1d1cea7deb5",
      "name": "Google Gemini Chat Model",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/push",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"to\": \"{{ $('Webhook1').item.json.body.events[0].source.userId }}\",\n  \"messages\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"{{ $json.textForLine }}\"\n    },\n    {\n      \"type\": \"image\",\n      \"originalContentUrl\": \"{{ $json.directImageUrl }}\",\n      \"previewImageUrl\": \"{{ $json.directImageUrl }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        304,
        -476
      ],
      "id": "0de52724-98ec-499f-9eb3-64aeb2cded6e",
      "name": "äººå·¥å¯©æ ¸",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "name": "={{ $('Webhook1').item.json.body.events[0].message.text }}-{{$today}}",
        "driveId": {
          "__rl": true,
          "value": "My Drive",
          "mode": "list",
          "cachedResultName": "My Drive",
          "cachedResultUrl": "https://drive.google.com/drive/my-drive"
        },
        "folderId": {
          "__rl": true,
          "value": "108j6EfRxI5AJIpN6_4XxUXFZFd_7l7Tj",
          "mode": "list",
          "cachedResultName": "åœ–ç‰‡",
          "cachedResultUrl": "https://drive.google.com/drive/folders/108j6EfRxI5AJIpN6_4XxUXFZFd_7l7Tj"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -368,
        -380
      ],
      "id": "0ffa760f-41c1-47b9-866a-2ed100df2053",
      "name": "Upload file",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "jsCode": "// 1. å–å¾— Google Drive ä¸Šå‚³å¾Œçš„æª”æ¡ˆ ID\nconst fileId = $('Upload file').first().json.id;\n\n// 2. å»ºç«‹ LINE å¯ä»¥ç›´æ¥è¨ªå•çš„åœ–ç‰‡ URL\nconst directImageUrl = `https://drive.google.com/uc?export=view&id=${fileId}`;\n\n// 3. å–å¾— AI Agent çš„ output\nconst out = $('AI Agent1').first().json.output;\n\n// 4. åˆä½µæ–‡æ¡ˆï¼Œä¸­è‹±æ–‡ç”¨ \\n æ–·è¡Œ\nlet textForLine = `${out['å¿ƒæƒ…èªéŒ„']['ä¸­æ–‡']}\\n${out['å¿ƒæƒ…èªéŒ„']['è‹±æ–‡']}`;\n\n// 5. å…¨é¢ escape è™•ç†ï¼ˆé¿å… JSON/LINE æ ¼å¼å‡ºéŒ¯ï¼‰\ntextForLine = textForLine\n  .replace(/\\\\/g, '\\\\\\\\')   // åæ–œç·š\n  .replace(/\"/g, '\\\\\"')     // é›™å¼•è™Ÿ\n  .replace(/\\n/g, '\\\\n')    // æ›è¡Œ\n  .replace(/\\r/g, '\\\\r')    // å›è»Š\n  .replace(/\\t/g, '\\\\t');   // Tab\n\n// 6. ä¸€æ¬¡ return æ‰€æœ‰éœ€è¦çš„è³‡æ–™\nreturn [{\n  json: {\n    directImageUrl: directImageUrl,\n    textForLine: textForLine\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        80,
        -476
      ],
      "id": "5ac1bba4-0b35-490a-bd29-b790947858f4",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "operation": "share",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "permissionsUi": {
          "permissionsValues": {
            "role": "reader",
            "type": "anyone",
            "allowFileDiscovery": true
          }
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -144,
        -380
      ],
      "id": "da5cd947-74ce-4c5e-849b-8312822362a3",
      "name": "Share file",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=æ ¹æ“šé—œéµå­—{{ $json.body.events[0].message.text }}å¯«å¿ƒæƒ…èªéŒ„",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=å°ˆé–€ç”Ÿæˆæ¯æ—¥å¿ƒæƒ…èªéŒ„ï¼šï¼ˆä¸­æ–‡èˆ‡è‹±æ–‡å…©ç¨®ï¼ŒçŸ­å¥ï¼Œæœ‰é»æ·±å¥§ï¼Œçœæ€ï¼‰ã€‚\nHashtagï¼šä»¥  {{ $json.body.events[0].message.text }} ç‚ºè»¸å¿ƒåœç¹ï¼Œ AIã€ç§‘æŠ€ã€æ•¸ä½è—è¡“ç‚ºæ ¸å¿ƒçš„å‰µæ–°å¹³å°ï¼Œè‡´åŠ›æ–¼æ¢ç´¢ AI è‡ªå‹•åŒ–ã€Stable Diffusionï¼ˆSDï¼‰ã€ComfyUI åŠå„é¡ç”Ÿæˆå¼ AI çš„æœ€æ–°æŠ€è¡“èˆ‡æ‡‰ç”¨ã€‚\n\nè«‹å‹™å¿…ä½¿ç”¨ä¸‹åˆ—æ ¼å¼è¼¸å‡ºï¼š\nå¿ƒæƒ…èªéŒ„ï¼šï¼ˆä¸­æ–‡èˆ‡è‹±æ–‡å…©ç¨®ï¼ŒçŸ­å¥ï¼Œé»æ·±å¥§ï¼Œçœæ€ï¼‰\nHashtagï¼šï¼ˆä¸­è‹±æ··åˆ hashtagï¼Œ3~5 å€‹ï¼‰\n\næ ¼å¼ç¯„ä¾‹å¦‚ä¸‹ï¼š\nå¿ƒæƒ…èªéŒ„ï¼šä¸­æ–‡ï¼š\n\nã€Œæ¯å€‹æ–°çš„æ—©æ™¨ï¼Œéƒ½æ˜¯ä¸€å€‹é‡æ–°å‡ºç™¼çš„æ©Ÿæœƒã€‚ç›¸ä¿¡è‡ªå·±ï¼Œé™½å…‰ç¸½åœ¨é¢¨é›¨å¾Œã€‚ã€\n\n\nè‹±æ–‡ï¼š\n\n\"Every new morning is a chance to start fresh. Believe in yourself â€” sunshine comes after the rain.\" \nHashtagï¼š#AI #ç§‘æŠ€ #æ•¸ä½è—è¡“ #å¿ƒéˆé›æ¹¯ #ç™‚ç™’"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        -1168,
        -232
      ],
      "id": "d7460a8c-bbb7-4ae1-9844-bb30f5704bbb",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [
        -592,
        -380
      ],
      "id": "cb0466f0-2ce9-451b-a4f9-30ed71a95413",
      "name": "Merge1"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"å¿ƒæƒ…èªéŒ„\": {\n    \"ä¸­æ–‡\": \"\",\n    \"è‹±æ–‡\": \"\"\n  },\n  \"Hashtag\": \"\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        -1032,
        -8
      ],
      "id": "be7b9482-d7d0-4d6a-b782-10dcc14243f0",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "jsCode": "// æ­£ç¢ºæŠ“å–åµŒå¥—åœ¨ \"AI Agent.output\" çš„å…§å®¹\nconst output = $input.first().json.output;\n\n// åˆä½µè²¼æ–‡å…§å®¹ï¼ˆä½¿ç”¨ã€Œå¿ƒæƒ…èªéŒ„ã€ä¸­çš„ä¸­æ–‡èˆ‡è‹±æ–‡ï¼‰\nconst mergedText = `ğŸ’¬ å¿ƒæƒ…èªéŒ„ï¼š\\n${output[\"å¿ƒæƒ…èªéŒ„\"][\"ä¸­æ–‡\"]}\\n${output[\"å¿ƒæƒ…èªéŒ„\"][\"è‹±æ–‡\"]}\\n\\n${output[\"Hashtag\"]}`;\n\n// å›å‚³åˆä½µå¾Œçš„å…§å®¹\nreturn [\n  {\n    json: {\n      post: mergedText\n    }\n  }\n];\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -816,
        -232
      ],
      "id": "7ff08217-3c96-4181-b79b-5024cfc9f933",
      "name": "Code"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-image",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-image (Nano Banana)"
        },
        "prompt": "=ç”Ÿæˆ {{ $json.body.events[0].message.text }} çš„ç…§ç‰‡\né¢¨æ ¼ç‚º Q ç‰ˆ",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        -1104,
        -528
      ],
      "id": "1a2399ae-7585-4d5c-91d9-b1b16591b64b",
      "name": "Generate an image1",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "IG&FB",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -1392,
        -380
      ],
      "id": "f0b38a15-796e-484a-98e1-62e311f80a58",
      "name": "Webhook1",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "dataTableId": {
          "__rl": true,
          "value": "EUO7vDBi8S9zn8tl",
          "mode": "list",
          "cachedResultName": "ig&fb",
          "cachedResultUrl": "/projects/4W71QCd0cKKsiKSS/datatables/EUO7vDBi8S9zn8tl"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "pictureurl": "={{ $('Upload file').item.json.webViewLink }}",
            "content": "={{ $('AI Agent1').item.json.output['å¿ƒæƒ…èªéŒ„']['ä¸­æ–‡'] }}\n{{ $('AI Agent1').item.json.output['å¿ƒæƒ…èªéŒ„']['è‹±æ–‡'] }}",
            "date": "={{$today.format('yyyy-MM-dd')}}",
            "keypoint": "={{ $('Webhook1').item.json.body.events[0].message.text }}",
            "status": false
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "keypoint",
              "displayName": "keypoint",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "content",
              "displayName": "content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "pictureurl",
              "displayName": "pictureurl",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "FBURL",
              "displayName": "FBURL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "igURL",
              "displayName": "igURL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        80,
        -284
      ],
      "id": "6ffaf4dc-f32f-4c4c-aae4-8ff233873de4",
      "name": "Insert row"
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "EUO7vDBi8S9zn8tl",
          "mode": "list",
          "cachedResultName": "ig&fb",
          "cachedResultUrl": "/projects/4W71QCd0cKKsiKSS/datatables/EUO7vDBi8S9zn8tl"
        },
        "filters": {
          "conditions": [
            {
              "keyName": "date",
              "keyValue": "={{ $today.format('yyyy-MM-dd') }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        -944,
        192
      ],
      "id": "36f32a0c-c740-40d9-82b7-4efb2110c059",
      "name": "Get row(s)"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.pictureurl }}",
          "mode": "url"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -720,
        192
      ],
      "id": "5205867d-3708-4f52-9189-82207aa80fac",
      "name": "Download file",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "9fb5f0af-49e0-4f4e-95dd-b48a32c1c58d",
              "leftValue": "={{ $json.fileSize }}",
              "rightValue": "=0",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -816,
        -528
      ],
      "id": "b7c26066-82cb-4e0a-8fff-a22f8d396417",
      "name": "If1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        624,
        288
      ],
      "id": "a236eca0-d21b-47f2-a1c2-f49b6ecf36f7",
      "name": "5s",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.body.events[0].message.text }}",
                    "rightValue": "ç™¼å¸ƒ",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "0a016417-0a00-41c4-8131-51ecdac7783b"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ç™¼å¸ƒ"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1a0167bd-cef0-4750-9636-8efaefcf3971",
                    "leftValue": "={{ $json.body.events[0].message.text }}",
                    "rightValue": "é‡æ–°ç”Ÿæˆ",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "é‡æ–°ç”Ÿæˆ"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        -1168,
        288
      ],
      "id": "4ee322d6-f21f-4f38-b726-6e448a0b6a7f",
      "name": "Switch"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "IG&FB",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -1392,
        288
      ],
      "id": "3cd9fad9-f7ab-4042-b68c-298f3214f91e",
      "name": "Webhook",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "EUO7vDBi8S9zn8tl",
          "mode": "list",
          "cachedResultName": "ig&fb",
          "cachedResultUrl": "/projects/4W71QCd0cKKsiKSS/datatables/EUO7vDBi8S9zn8tl"
        },
        "filters": {
          "conditions": [
            {
              "keyName": "status",
              "condition": "isFalse"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        -944,
        384
      ],
      "id": "39c10119-cf10-45cd-84b6-a97865cc3c4a",
      "name": "Get row(s)1"
    },
    {
      "parameters": {
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "value": "EUO7vDBi8S9zn8tl",
          "mode": "list",
          "cachedResultName": "ig&fb",
          "cachedResultUrl": "/projects/4W71QCd0cKKsiKSS/datatables/EUO7vDBi8S9zn8tl"
        },
        "filters": {
          "conditions": [
            {
              "keyName": "date",
              "keyValue": "={{ $today.format('yyyy-MM-dd') }}"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "status": true
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "keypoint",
              "displayName": "keypoint",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "date",
              "displayName": "date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "content",
              "displayName": "content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "pictureurl",
              "displayName": "pictureurl",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "FBURL",
              "displayName": "FBURL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "igURL",
              "displayName": "igURL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        1520,
        288
      ],
      "id": "56434001-6d62-4764-92b9-20aa3a164d8b",
      "name": "Update row(s)"
    },
    {
      "parameters": {
        "content": "IG è¼¸å…¥é—œéµå­—\nå³å¯é€é Gemini è‡ªå‹•ç”¢åœ– ä¸¦ç”¢ç”Ÿç›¸é—œæ–‡ç« \nç¶“ç”± line äººå·¥å¯©æ ¸\n",
        "height": 784,
        "width": 2112
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1568,
        -672
      ],
      "typeVersion": 1,
      "id": "dc3cc3ab-b5f8-437c-8879-729c41158f9e",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "Line å›å¾© ok\nå³å¯åŒæ­¥ç™¼å¸ƒ IG åŠ FB",
        "height": 432,
        "width": 3248,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1568,
        128
      ],
      "typeVersion": 1,
      "id": "389f5a78-b2c6-4f34-b762-1026cc4e0366",
      "name": "Sticky Note1"
    }
  ],
  "connections": {
    "Code2": {
      "main": [
        [
          {
            "node": "supabase",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "supabase": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "5s",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Facebook Graph API": {
      "main": [
        [
          {
            "node": "ç™¼é€å›æ‡‰çµ¦ LINE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "ç™¼é€å›æ‡‰çµ¦ LINE1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Upload file": {
      "main": [
        [
          {
            "node": "Share file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "äººå·¥å¯©æ ¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Share file": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          },
          {
            "node": "Insert row",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Upload file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Generate an image1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook1": {
      "main": [
        [
          {
            "node": "Generate an image1",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)": {
      "main": [
        [
          {
            "node": "Download file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download file": {
      "main": [
        [
          {
            "node": "Facebook Graph API",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Generate an image1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "5s": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Insert row": {
      "main": [
        []
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Get row(s)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)1": {
      "main": [
        []
      ]
    },
    "ç™¼é€å›æ‡‰çµ¦ LINE1": {
      "main": [
        [
          {
            "node": "Update row(s)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "d1fe7ea7-886b-42be-9ddf-c681a8831ab5",
  "triggerCount": 2,
  "shared": [
    {
      "updatedAt": "2025-09-03T16:29:55.866Z",
      "createdAt": "2025-09-03T16:29:55.866Z",
      "role": "workflow:owner",
      "workflowId": "g5d0g7VUIM87J3X8",
      "projectId": "4W71QCd0cKKsiKSS"
    }
  ],
  "tags": []
}