{
  "name": "é–‹ç™¼ä¿¡",
  "nodes": [
    {
      "parameters": {
        "jsCode": "const html = $input.first().json.data;\n\n// å¾ HTML ä¸­æå–ç¸½ç­†æ•¸\nconst totalMatch = html.match(/å…±\\s*(\\d+)\\s*é …è³‡æ–™/);\nconst totalItems = totalMatch ? parseInt(totalMatch[1]) : 0;\n\nconsole.log('ç¸½å…±æœ‰ ' + totalItems + ' ç­†è³‡æ–™');\n\n// è¨ˆç®—ç¸½é æ•¸ (æ¯é  10 ç­†)\nconst itemsPerPage = 10;\nconst totalPages = Math.ceil(totalItems / itemsPerPage);\n// ğŸ†• å¾å‰ä¸€å€‹ç¯€é»å–å¾—ç”¢æ¥­é¡åˆ¥è³‡è¨Š\nconst industryCode = $input.first().json.industryCode || '';\nconst industryName = $input.first().json.industryName || '';\n\nconsole.log('ç¸½å…±æœ‰ ' + totalPages + ' é ');\n\n// ç”¢ç”Ÿæ‰€æœ‰é é¢çš„ URL\nconst urls = [];\nfor (let i = 1; i <= totalPages; i++) {\n  urls.push({\n    json: {\n      parkName: \"åœŸåŸç”¢æ¥­åœ’å€\",\n      factoryUrl: `https://www.bip.gov.tw/iphw/tucheng/factory.do?method=list&page=${i}`,\n      page: i,\n      totalPages: totalPages,\n      totalItems: totalItems,\n      industryCode: industryCode,      // ğŸ†• åŠ é€™è¡Œ\n      industryName: industryName        // ğŸ†• åŠ é€™è¡Œ\n    }\n  });\n}\n\nreturn urls;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        48,
        -80
      ],
      "id": "61806477-9e90-4d64-81a5-de1328f16694",
      "name": "è¨ˆç®—ç¸½é æ•¸åŠURL"
    },
    {
      "parameters": {
        "url": "={{ $json.factoryUrl }}",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "profCode8",
              "value": "={{ $('ä¿®æ”¹è¡Œæ¥­åˆ¥').item.json.industryCode }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        272,
        -80
      ],
      "id": "ca740708-5559-4733-9fbb-4ac5bcdc8635",
      "name": "æ ¹æ“šé æ•¸URLæ“·å–è³‡æ–™"
    },
    {
      "parameters": {
        "url": "https://www.bip.gov.tw/iphw/tucheng/factory.do?method=list",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "profCode8",
              "value": "={{ $json.industryCode }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -256,
        -80
      ],
      "id": "26ac93c0-7c15-4817-af94-338df4c0bddd",
      "name": "ç¶“æ¿Ÿéƒ¨åœŸåŸç”¢æ¥­åœ’å€æœå‹™ä¸­å¿ƒ"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        496,
        -80
      ],
      "id": "25d5b920-333d-4a14-9142-9a8a280d2fa0",
      "name": "Loop Over Items"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me",
      "typeVersion": 1,
      "position": [
        2672,
        48
      ],
      "id": "3813987c-55f4-486f-bc7c-f5321b073c62"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 825314960,
          "mode": "list",
          "cachedResultName": "ç¶“æ¿Ÿéƒ¨å•†å·¥ç™»è¨˜",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=825314960"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "status(æœå°‹)": "no",
            "å·¥å» ç™»è¨˜": "={{ $json['å·¥å» ç™»è¨˜'] }}"
          },
          "matchingColumns": [
            "å·¥å» ç™»è¨˜"
          ],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç¶²ç«™(åœ’å€æœå‹™ä¸­å¿ƒ)",
              "displayName": "ç¶²ç«™(åœ’å€æœå‹™ä¸­å¿ƒ)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2480,
        144
      ],
      "id": "40d47af3-d182-4b5a-90bd-863c648fd61f",
      "name": "Update row in sheet",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2928,
        96
      ],
      "id": "e2a2b894-a473-4b1b-93b6-8f552af6d184",
      "name": "Wait",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "fieldToSplitOut": "=companies",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        1152,
        48
      ],
      "id": "4039ba02-6c43-42dd-8e97-c0b58248ac7a",
      "name": "Split Out1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 825314960,
          "mode": "list",
          "cachedResultName": "ç¶“æ¿Ÿéƒ¨å•†å·¥ç™»è¨˜",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=825314960"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $('Split Out1').item.json.company }}",
            "åœ°å€": "={{ $('Split Out1').item.json.address }}",
            "telephone": "={{ $('Loop Over Items1').item.json.phone }}",
            "å·¥å» ç™»è¨˜": "={{ $('Loop Over Items1').item.json.licenseNumber }}",
            "ç¶²ç«™(åœ’å€æœå‹™ä¸­å¿ƒ)": "={{ $('Loop Over Items1').item.json.detailUrl }}",
            "çˆ¬å–time": "={{ $('Schedule Trigger').item.json.timestamp }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç¶²ç«™(åœ’å€æœå‹™ä¸­å¿ƒ)",
              "displayName": "ç¶²ç«™(åœ’å€æœå‹™ä¸­å¿ƒ)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2048,
        144
      ],
      "id": "a1c4e52e-791d-48a1-9ac0-8622001add11",
      "name": "Append row in sheet",
      "executeOnce": false,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "content": "çˆ¬å–ç¶“æ¿Ÿéƒ¨å•†å·¥ç™»è¨˜çš„å·¥å» (å¯ä»¥æŒ‘é¸ ç”¢æ¥­åˆ¥)\nç¾åœ¨é€™å¥—å¯ä»¥çˆ¬åˆ° æ­£ç¢ºåœ°å€ é›»è©± \n",
        "height": 768,
        "width": 3024
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -960,
        -464
      ],
      "typeVersion": 1,
      "id": "f63d099a-0479-4dc2-8380-b9fb138e125b",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 825314960,
          "mode": "list",
          "cachedResultName": "ç¸½å·¥å» æ•¸é‡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=825314960"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "email",
              "lookupValue": "æœªæ‰¾åˆ°"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -608,
        592
      ],
      "id": "05f1c077-b333-4262-b388-b2f520653751",
      "name": "Get row(s) in sheet1",
      "executeOnce": false,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=è«‹ æœå°‹ã€Œ{{ $json.Company_Name }}ã€é€™å®¶å°ç£å…¬å¸çš„å®˜æ–¹ç¶²ç«™å’Œ Email å’Œ å…¬å¸åœ°å€ å’Œé›»è©±\n\nåœ°å€é›»è©±å¯ä»¥ç”¨ï¼š{{ $json[\"åœ°å€\"] }}\n{{ $json.telephone }}\né€²ä¸€æ­¥åƒè€ƒæœå°‹\n\nåœ°å€é›»è©±ä¹Ÿå¯ä»¥ç”¨ google map æœå°‹\n\næœ‰å¤šå€‹Email å°±é€šé€šæŠ“ä¸‹ä¾†\n\næˆ‘æ‰€æœ‰çš„å…¬å¸åœ°å€ éƒ½æ˜¯åœ¨å°åŒ— æ–°åŒ—åœ°å€\nå¦‚æœæ‰¾åˆ° éæ–°åŒ— å°åŒ— ä¸€å®šæ˜¯æ‰¾éŒ¯\nè«‹ä»¥æ–°åŒ— å°åŒ—ç‚ºæ­£ç¢ºå…¬å¸åœ°å€\n\nä½ æœ‰Tools å¯ä»¥ç”¨ä¾†æŸ¥è©¢\nMessage a model in Perplexity\n\n\nè«‹éš¨æ™‚ä½¿ç”¨ä»–æœå°‹æ­£ç¢ºåœ°å€å’Œé›»è©±",
        "options": {
          "systemMessage": "=ä½ æ˜¯å°ˆæ¥­çš„ä¼æ¥­è³‡è¨Šæœå°‹åŠ©æ‰‹ã€‚è«‹æœå°‹å°ç£å…¬å¸çš„å®˜æ–¹ç¶²ç«™å’Œè¯çµ¡ Emailå’Œå…¬å¸åœ°å€å’Œé›»è©±ã€‚\nåœ°å€ã€é›»è©±\n\næœ‰å¤šå€‹Email å°±é€šé€šæŠ“ä¸‹ä¾†\n\nä½ æœ‰Tools å¯ä»¥ç”¨ä¾†æŸ¥è©¢\nMessage a model in Perplexity\n\næˆ‘æ‰€æœ‰çš„å…¬å¸åœ°å€ éƒ½æ˜¯åœ¨å°åŒ— æ–°åŒ—åœ°å€\nå¦‚æœæ‰¾åˆ° éæ–°åŒ— å°åŒ— ä¸€å®šæ˜¯æ‰¾éŒ¯\nè«‹ä»¥æ–°åŒ— å°åŒ—ç‚ºæ­£ç¢ºå…¬å¸åœ°å€\n\nè¼¸å‡ºæ ¼å¼ï¼ˆå¿…é ˆæ˜¯ç´” JSONï¼Œä¸è¦æœ‰å…¶ä»–æ–‡å­—ï¼‰ï¼š\n\n\n{\n  \"official_website\": \"å…¬å¸å®˜ç¶² URL, ä¾‹å¦‚ https://example.com\",\n  \"contact_email\": \"è¯çµ¡ Email,ä¾‹å¦‚ info@example.com\",\n  \"official_address\": \"å…¬å¸åœ°å€,ä¾‹å¦‚ å°åŒ—å¸‚ä¿¡ç¾©å€XXè·¯XXè™Ÿ\",\n  \"telephone\": \"02-1234-5678\",\n  \"confidence\": \"high/medium/low\",\n\n  \"source\": \"è³‡è¨Šä¾†æºèªªæ˜\"\n}\n``````json\n{\n  \"official_website\": \"å…¬å¸å®˜ç¶² URL, ä¾‹å¦‚ https://example.com\",\n  \"contact_email\": \"è¯çµ¡ Email,ä¾‹å¦‚ info@example.com æˆ– æœªæ‰¾åˆ°\",\n  \"official_address\": \"å…¬å¸åœ°å€,ä¾‹å¦‚ å°åŒ—å¸‚ä¿¡ç¾©å€XXè·¯XXè™Ÿ\",\n  \"telephone\": \"02-1234-5678\",\n  \"confidence\": \"high/medium/low\",\n  \"source\": \"è³‡è¨Šä¾†æºèªªæ˜\"\n}\n\n\nä½ æœ‰å·¥å…· SerpAPI\nå¯ä»¥ç”¨ä¾†æœå°‹ google åœ°å€ é›»è©±"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        64,
        560
      ],
      "id": "a1191b56-bba5-40f9-8121-913821b59f24",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": "openai/gpt-4o",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        48,
        784
      ],
      "id": "14e0da51-5ce4-4bed-bbcf-3e12a1cf8caf",
      "name": "OpenRouter Chat Model",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "jsCode": "// å–å¾—å…¬å¸åç¨±\nconst companyName = $('Get row(s) in sheet1').first().json.Company_Name || 'æœªçŸ¥å…¬å¸';\n\n// å–å¾— Perplexity çš„å›æ‡‰\nconst perplexityResponse = $input.first().json.output || '';\n\nconsole.log(`${companyName} - Perplexity åŸå§‹å›æ‡‰: ${perplexityResponse}`);\n\n// è§£æ JSON å›æ‡‰\nlet result = {\n    official_website: \"æœªæ‰¾åˆ°\",\n    contact_email: \"æœªæ‰¾åˆ°\",\n    official_address: \"æœªæ‰¾åˆ°\",\n    telephone: \"æœªæ‰¾åˆ°\",\n    confidence: \"low\",\n    source: \"AI è§£æå¤±æ•—\"\n};\n\ntry {\n    // æ¸…é™¤å¯èƒ½çš„ markdown æ¨™è¨˜å’Œå¤šé¤˜ç©ºç™½\n    let cleanResponse = perplexityResponse\n        .replace(/```json\\n?/g, '')\n        .replace(/```\\n?/g, '')\n        .trim();\n    \n    // å¦‚æœå›æ‡‰åŒ…å«å¤šå€‹ JSONï¼Œåªå–ç¬¬ä¸€å€‹\n    if (cleanResponse.includes('}{')) {\n        cleanResponse = cleanResponse.split('}{')[0] + '}';\n    }\n    \n    result = JSON.parse(cleanResponse);\n    console.log(`âœ… ${companyName} è§£ææˆåŠŸ`);\n} catch (error) {\n    console.log(`âŒ ${companyName} JSON è§£æå¤±æ•—: ${error.message}`);\n    // å˜—è©¦å¾æ–‡å­—ä¸­æå–è³‡è¨Š\n    const websiteMatch = perplexityResponse.match(/https?:\\/\\/[^\\s\"']+/);\n    const emailMatch = perplexityResponse.match(/[\\w\\.-]+@[\\w\\.-]+\\.\\w+/);\n    \n    if (websiteMatch) result.official_website = websiteMatch[0];\n    if (emailMatch) result.contact_email = emailMatch[0];\n    result.source = \"å¾æ–‡å­—ä¸­æå–\";\n}\n\nconsole.log(`${companyName} æœ€çµ‚çµæœ: å®˜ç¶²=${result.official_website}, Email=${result.contact_email}`);\n\nreturn [{\n    json: {\n        Company_Name: companyName,\n        Official_Website: result.official_website,\n        Contact_Email: result.contact_email,\n        Official_Address: result.official_address,\n        telephone: result.telephone,\n        Confidence: result.confidence,\n        Source: result.source\n    }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        416,
        560
      ],
      "id": "598b7f3d-a650-4bc1-8a87-13ec6f80f927",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -384,
        528
      ],
      "id": "429da0fc-f5eb-42fd-9278-3948494ca25a",
      "name": "Loop Over Items3"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 825314960,
          "mode": "list",
          "cachedResultName": "ç¸½å·¥å» æ•¸é‡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=825314960"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.Company_Name }}",
            "status(æœå°‹)": "ready",
            "åœ°å€": "={{ $json.Official_Address }}",
            "telephone": "={{ $json.telephone }}",
            "çˆ¬å–time": "={{ $now }}",
            "email": "={{ $json.Contact_Email }}",
            "web": "={{ $json.Official_Website }}"
          },
          "matchingColumns": [
            "Company_Name"
          ],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1216,
        560
      ],
      "id": "8a6811c5-eb8f-48c4-9c68-8d37ae5e1d85",
      "name": "Update row in sheet2",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "model": "perplexity/sonar-pro-search",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        720,
        784
      ],
      "id": "fb81ddb0-ca20-47e2-a5f7-fad802628bf8",
      "name": "OpenRouter Chat Model1",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "jsCode": "// ç²å–å‰ä¸€å€‹æ­¥é©Ÿ (Code in JavaScript3) çš„çµæœ\nconst previousResult = $('Code in JavaScript3').first().json;\n\n// ç²å–é©—è­‰æ­¥é©Ÿ (Website Verification Agent) çš„åŸå§‹å›æ‡‰\nconst verificationResponse = $input.first().json.output || '';\n\n// åˆå§‹åŒ–æœ€çµ‚çµæœ\nlet finalResult = {\n    ...previousResult,\n    Verification_Note: \"æœªé€²è¡ŒäºŒæ¬¡é©—è­‰æˆ–é©—è­‰å¤±æ•—\",\n};\n\ntry {\n    // å˜—è©¦è§£æé©—è­‰ Agent çš„ JSON å›æ‡‰\n    let cleanResponse = verificationResponse\n        .replace(/```json\\n?/g, '')\n        .replace(/```\\n?/g, '')\n        .trim();\n\n    const verificationResult = JSON.parse(cleanResponse);\n\n    // æ ¹æ“š AI é©—è­‰çµæœæ›´æ–° Confidence å’Œ Source\n    if (verificationResult.is_official_match === true) {\n        // å¦‚æœ AI å†æ¬¡ç¢ºèªåŒ¹é…ï¼Œæé«˜ä¿¡å¿ƒåº¦\n        if (finalResult.Confidence === 'medium') {\n            finalResult.Confidence = 'high';\n        } else if (finalResult.Confidence === 'low') {\n            finalResult.Confidence = 'medium';\n        }\n        finalResult.Verification_Note = verificationResult.verification_note || \"AI å†æ¬¡ç¢ºèªç¶²å€æœ‰æ•ˆ\";\n        finalResult.Source = finalResult.Source + \" + AIé©—è­‰\";\n    } else if (verificationResult.is_official_match === false) {\n        // å¦‚æœ AI èªç‚ºä¸åŒ¹é…ï¼Œé™ä½ä¿¡å¿ƒåº¦æˆ–å°‡ç¶²å€é‡ç½®\n        finalResult.Confidence = 'low';\n        finalResult.Official_Website = \"æœªæ‰¾åˆ° (AIé©—è­‰å¤±æ•—)\";\n        finalResult.Verification_Note = verificationResult.verification_note || \"AI é©—è­‰çµæœä¸ç¬¦\";\n    }\n} catch (error) {\n    console.log(`âŒ é©—è­‰çµæœ JSON è§£æå¤±æ•—: ${error.message}`);\n    finalResult.Verification_Note = \"AI é©—è­‰çµæœæ ¼å¼éŒ¯èª¤ï¼Œæœªæ›´æ–°çµæœ\";\n}\n\n// è¿”å›æœ€çµ‚çš„çµæœ\nreturn [{\n    json: finalResult\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        992,
        560
      ],
      "id": "987fd1ad-5920-46bf-8f31-464770c27ed0",
      "name": "Code in JavaScript4"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=è«‹æœå°‹ã€Œ{{ $json.Company_Name }}ã€é€™å®¶å…¬å¸çš„**å®˜æ–¹ç¶²ç«™**ï¼Œä¸¦åˆ¤æ–·æˆ‘æä¾›çš„ç¶²ç«™ã€Œ{{ $json.Official_Website }}ã€æ˜¯å¦ç‚ºå…¶**å®˜æ–¹ç¶²ç«™**æˆ–**ç¤¾ç¾¤åª’é«”**\n\næˆ‘æ‰€æœ‰çš„å…¬å¸åœ°å€ éƒ½æ˜¯åœ¨å°åŒ— æ–°åŒ—åœ°å€\nå¦‚æœæ‰¾åˆ° éæ–°åŒ— å°åŒ— ä¸€å®šæ˜¯æ‰¾éŒ¯\nè«‹ä»¥æ–°åŒ— å°åŒ—ç‚ºæ­£ç¢ºå…¬å¸åœ°å€",
        "options": {
          "systemMessage": "ä½ æ˜¯ä¸€å€‹ç¶²ç«™é©—è­‰å°ˆå®¶ã€‚è«‹æ ¹æ“šæœå°‹çµæœåˆ¤æ–·æä¾›çš„ç¶²ç«™æ˜¯å¦ç‚ºå®˜æ–¹ç¶²ç«™ã€‚ä½ çš„å›æ‡‰**å¿…é ˆæ˜¯ç´” JSON**ï¼Œä¸è¦æœ‰å…¶ä»–æ–‡å­—ã€‚\næˆ‘æ‰€æœ‰çš„å…¬å¸åœ°å€ éƒ½æ˜¯åœ¨å°åŒ— æ–°åŒ—åœ°å€\nå¦‚æœæ‰¾åˆ° éæ–°åŒ— å°åŒ— ä¸€å®šæ˜¯æ‰¾éŒ¯\nè«‹ä»¥æ–°åŒ— å°åŒ—ç‚ºæ­£ç¢ºå…¬å¸åœ°å€\n\nè¼¸å‡ºæ ¼å¼ï¼š\\n{\\nÂ  \"is_official_match\": true/false,\\nÂ  \"verification_source\": \"æœå°‹çµæœ/ç¶²ç«™æ¨™é¡Œ/æœªæ‰¾åˆ°\",\\nÂ  \"verification_note\": \"ç°¡çŸ­çš„é©—è­‰èªªæ˜ï¼Œä¾‹å¦‚ï¼šç¢ºèªç‚ºå®˜ç¶²é¦–é \"}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        656,
        448
      ],
      "id": "32549764-784c-4922-afe3-a28bc2a4233c",
      "name": "Website Verification Agent",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "send",
        "to": "C7f5304c2cd5ecde7dcdc6e55178e7c4e"
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        0,
        368
      ],
      "id": "478d809b-9715-4de1-838d-eb6895b6c8ee",
      "name": "Line Messaging",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1440,
        688
      ],
      "id": "f52129d8-898e-4458-a7f6-8230add20755",
      "name": "Wait3",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "q": "={{ $json.Company_Name }} åœŸåŸ",
        "additionalFields": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-serpapi.serpApi",
      "typeVersion": 1,
      "position": [
        -160,
        624
      ],
      "id": "62b3199a-2ea7-4e57-88a0-b35a124bc9f3",
      "name": "Google search",
      "credentials": "[REMOVED]",
      "disabled": true
    },
    {
      "parameters": {
        "messages": {
          "message": [
            {
              "content": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('message0_Text', ``, 'string') }}"
            }
          ]
        },
        "options": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexityTool",
      "typeVersion": 1,
      "position": [
        208,
        784
      ],
      "id": "653edf9b-16e2-49c3-8ecc-28e976654747",
      "name": "Message a model in Perplexity",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1120,
        -80
      ],
      "id": "c47416cb-9263-44bf-9b09-ffc85a1709e8",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/push",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"to\": \"C7f5304c2cd5ecde7dcdc6e55178e7c4e\",\n  \"messages\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"ä»Šæ—¥ {{ $now.format('yyyy-MM-dd HH:mm:ss') }}\\nç”¢æ¥­é¡åˆ¥ç‚ºï¼š{{ $('ä¿®æ”¹è¡Œæ¥­åˆ¥').item.json.industryName }}\\nå…± {{ $json.totalDataCount }} å®¶å·¥å»   çˆ¬èŸ²å·²å®Œæˆ\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1280,
        -160
      ],
      "id": "393eeed5-5226-40de-8e4f-48714b9ffe7a",
      "name": "ç™¼é€å›æ‡‰çµ¦ LINE",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 825314960,
          "mode": "list",
          "cachedResultName": "ç¶“æ¿Ÿéƒ¨å•†å·¥ç™»è¨˜",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=825314960"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Company_Name",
              "lookupValue": "={{ $json.company }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1600,
        128
      ],
      "id": "18faa100-2c76-4d95-a4c6-81f8a511b688",
      "name": "Get row(s) in sheet",
      "alwaysOutputData": true,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1376,
        48
      ],
      "id": "75ed9f8e-b15a-4a7a-b4dc-8e4cb0c6f223",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        688,
        -256
      ],
      "id": "f9925bc9-6eb8-487a-bf6f-f56ce6eaf02b",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "jsCode": "// æ­¥é©Ÿ 1: å­˜å–ç¬¬ä¸€å€‹è¼¸å…¥é …ç›®çš„ JSON å…§å®¹\nconst inputItem = items[0].json;\n\n// æ­¥é©Ÿ 2: å­˜å– data åˆ—è¡¨ä¸¦è¨ˆç®—é•·åº¦\n// é€™è£¡å‡è¨­æ‚¨çš„è³‡æ–™çµæ§‹ä¸€å®šå­˜åœ¨ inputItem.data\nconst dataCount = inputItem.data.length;\n\n// æ­¥é©Ÿ 3: å»ºç«‹ä¸€å€‹æ–°çš„é …ç›®ä¾†è¼¸å‡ºé€™å€‹çµæœ\n// n8n Code ç¯€é»å¿…é ˆå›å‚³ä¸€å€‹é™£åˆ— (Array)\nreturn [\n  {\n    json: {\n      totalDataCount: dataCount\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        880,
        -256
      ],
      "id": "4440e9b0-2502-49cb-8169-bcc1eb636cea",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2256,
        144
      ],
      "id": "e22d2b0c-e2f7-4a9b-aa35-d1ba29ee4c89",
      "name": "Wait1",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "content": "æ¯å¤©å®šæ™‚\nçˆ¬å– sheet ç¶“æ¿Ÿéƒ¨å•†å·¥ç™»è¨˜  çš„å…¬å¸åç¨±\næœå°‹ åœ°å€ é›»è©± ç¶²ç«™ email",
        "height": 656,
        "width": 2720,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -992,
        384
      ],
      "typeVersion": 1,
      "id": "1e316368-95ad-464a-aca4-ad41467d2033",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "url": "https://script.google.com/macros/s/AKfycbz41Hn5AyixSW8DX4aJItoZiXxMjHWwdSpDcDILoHjUILmqPyUBPmfhxQ6tF3-7pt4R/exec",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1120,
        -336
      ],
      "id": "cb654a19-e02e-4491-ac76-5ce705344841",
      "name": "å›å ±çµ¦ GAS"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "25fee9e0-6512-4202-9855-34c8004ecc7c",
              "leftValue": "={{ $json.Company_Name }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1824,
        144
      ],
      "id": "1b8f7554-b5fd-4a05-bfac-0cff3eee0572",
      "name": "é‡è¤‡çš„"
    },
    {
      "parameters": {
        "jsCode": "// âœ… æ­£ç¢ºï¼šå–å¾—ç•¶å‰é€™å€‹ Item çš„è³‡æ–™\nconst html = $input.item.json.data;\nconst page = $input.item.json.page || 1;\nconst industryName = $input.item.json.industryName || 'æœªåˆ†é¡'; \n\n// æ‰¾å‡ºæ‰€æœ‰å…¬å¸è³‡æ–™å€å¡Š\nconst listItems = html.match(/<li class=\"list-group-item list-group-item-action\">[\\s\\S]*?<\\/li>/g);\n\nif (!listItems || listItems.length === 0) {\n  return [{\n    json: {\n      error: 'æœªæ‰¾åˆ°å…¬å¸è³‡æ–™',\n      page: page\n    }\n  }];\n}\n\nconst companies = [];\n\nlistItems.forEach(item => {\n  // æå–å…¬å¸åç¨±\n  const nameMatch = item.match(/<strong>([^<]+)<\\/strong>/);\n  \n  // æå–é€£çµ\n  const linkMatch = item.match(/href=\"(factory\\.do\\?method=goContent[^\"]+)\"/);\n  \n  // æå–åœ°å€\n  const addressMatch = item.match(/col-md-4 ps-0\">\\s*\\n?\\s*([^\\n<]+)/);\n  \n  // æå–é›»è©±\n  const phoneMatch = item.match(/col-md-2 ps-0\">\\s*\\n?\\s*([^\\n<]+)/);\n  \n  // æå–é¡åˆ¥\n  const categoryMatch = item.match(/<span class=\"btn btn-outline-success disabled[^\"]*\"[^>]*>([^<]+)<\\/span>/);\n\n// ğŸ†• æå–å·¥å» ç™»è¨˜è­‰è™Ÿ\n  const licenseMatch = item.match(/col-12 col-md-1 ps-0 pe-1\">([^<]*)<\\/span>/);\n  const licenseNumber = licenseMatch ? licenseMatch[1].trim() : '';\n  // ğŸ†• åªä¿ç•™ã€Œæ²’æœ‰ã€å·¥å» ç™»è¨˜è­‰çš„å» å•†\nif (licenseNumber === '') {\n  return; // å¦‚æœæœ‰ç™»è¨˜è­‰è™Ÿï¼Œå°±è·³é\n}\n  \n  \n  if (nameMatch) {\n    companies.push({\n      company: nameMatch[1].trim(),\n      industryCategory: industryName,  // ğŸ†• åŠ é€™è¡Œï¼šç”¢æ¥­é¡åˆ¥ä¸­æ–‡\n      category: categoryMatch ? categoryMatch[1].trim() : '',\n      detailUrl: linkMatch ? 'https://www.bip.gov.tw/iphw/tucheng/' + linkMatch[1] : '',\n      address: addressMatch ? addressMatch[1].trim() : '',\n      phone: phoneMatch ? phoneMatch[1].trim() : '',\n      licenseNumber: licenseNumber,\n      page: page\n    });\n  }\n});\n\n// âœ… å›å‚³åŒ…å« companies é™£åˆ—çš„ç‰©ä»¶\nreturn [{ json: { companies: companies, totalCompanies: companies.length, page: page } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        928,
        48
      ],
      "id": "59c4701f-67a2-44df-ac7d-d254ccdf1fa4",
      "name": "è§£æå„å·¥å» è³‡æ–™(æœ‰å·¥å» ç™»è¨˜çš„)",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -816,
        1584
      ],
      "id": "5ba74cf2-e65c-40c6-b3b8-a695415e1bc8",
      "name": "Schedule Trigger1"
    },
    {
      "parameters": {
        "url": "https://www.taiwanhandtools.com.tw/html/company.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "page",
              "value": "={{ $json.page }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -848,
        2688
      ],
      "id": "8bb16261-8cf5-472c-b34f-a25ac6ad7cd8",
      "name": "å…¬æœƒ - æŠ“å–é¦–é  (GET)"
    },
    {
      "parameters": {
        "url": "https://www.taiwanhandtools.com.tw/html/company.php?page={{ $json.page }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -304,
        2544
      ],
      "id": "b9d4014f-5fcc-4724-b4af-1c57c6fd409d",
      "name": "å…¬æœƒ - æŠ“å–æ‰€æœ‰é é¢ (GET + UA)"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "CompanyName",
              "cssSelector": ".title-list .bar-1 a",
              "returnArray": true
            },
            {
              "key": "Address",
              "cssSelector": ".title-list .bar-2",
              "returnArray": true
            },
            {
              "key": "Phone",
              "cssSelector": ".title-list .bar-3",
              "returnArray": true
            },
            {
              "key": "Website",
              "cssSelector": ".title-list .bar-5 a",
              "returnArray": true
            },
            {
              "key": "DetailUrl",
              "cssSelector": ".title-list .bar-1 a",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        -48,
        2576
      ],
      "id": "985970af-2897-43c0-b8b2-f6af2811131e",
      "name": "HTML - æå–å¤šé åˆ—è¡¨"
    },
    {
      "parameters": {
        "jsCode": "const inputItems = $input.all();\nconst outputItems = [];\n\nfor (const inputItemWrapper of inputItems) {\n    const inputItem = inputItemWrapper.json;\n\n    const companyNames = inputItem.CompanyName;\n\n    if (!companyNames || companyNames.length === 0) {\n        continue;\n    }\n\n    const numItems = companyNames.length;\n    \n    // å–å¾—è¿½è¹¤è³‡è¨Š\n    const totalPages = inputItem.totalPages || '';\n    const industryCode = inputItem.industryCode || '';\n    \n    // éæ­·æ‰€æœ‰ç´¢å¼•ï¼Œå°‡åŒä¸€ç´¢å¼•ä¸‹çš„æ‰€æœ‰è³‡æ–™çµ„åˆèµ·ä¾† (å³åˆ†æ‹†æ“ä½œ)\n    for (let i = 0; i < numItems; i++) {\n        // æ¸…ç†é›»è©±è™Ÿç¢¼ï¼šç§»é™¤ <br> æ¨™ç±¤å’Œå¤šé¤˜ç©ºç™½\n        const rawPhone = inputItem.Phone[i] || '';\n        const cleanedPhone = rawPhone.replace(/\\s*<br\\/>\\s*/g, ' / ').replace(/\\s+/g, ' ').trim();\n        \n        // çµ„åˆæˆä¸€å€‹æ–°çš„ Item\n        const newItem = {\n            CompanyName: companyNames[i],\n            Address: inputItem.Address[i],\n            Phone: cleanedPhone,\n            Website: inputItem.Website[i],\n            DetailUrl: inputItem.DetailUrl[i],\n            \n            // ä¿ç•™è¿½è¹¤è³‡è¨Š\n            totalPages: totalPages,\n            industryCode: industryCode\n        };\n        \n        outputItems.push({ json: newItem });\n    }\n}\n\nreturn outputItems;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        448,
        2528
      ],
      "id": "d7a34ca1-27bf-434e-9147-ed844f355ecf",
      "name": "åˆ†æ - åˆ†æ‹†èˆ‡æ¸…ç†"
    },
    {
      "parameters": {
        "url": "https://www.taiwanhandtools.com.tw/html/{{ $json.DetailUrl }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        704,
        2528
      ],
      "id": "927ec9cd-6236-49c5-ba0c-d1216a5ab196",
      "name": "å…¬æœƒ - æŠ“å– Email é "
    },
    {
      "parameters": {
        "jsCode": "const cheerio = require('cheerio'); \n\nconst outputItems = [];\n\nfor (const item of $input.all()) {\n    const html = item.json.data;\n    if (!html || typeof html !== 'string') {\n        outputItems.push({ json: { ...item.json, Email: '' } }); \n        continue;\n    }\n    \n    const $ = cheerio.load(html);\n    \n    const emailWithMailto = $('a[href^=\"mailto:\"]').attr('href') || '';\n    \n    let cleanedEmail = '';\n\n    if (emailWithMailto.startsWith('mailto:')) {\n        cleanedEmail = emailWithMailto.substring(7);\n        \n        const subjectIndex = cleanedEmail.indexOf('?');\n        if (subjectIndex !== -1) {\n            cleanedEmail = cleanedEmail.substring(0, subjectIndex);\n        }\n    } else {\n        cleanedEmail = '';\n    }\n\n    outputItems.push({\n        json: {\n            ...item.json,\n            Email: cleanedEmail\n        }\n    });\n}\n\nreturn outputItems;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        928,
        2528
      ],
      "id": "59408a1f-bcbf-4b7a-8240-21f9dac44f2f",
      "name": "Code - æå–ä¸¦æ¸…ç† Email"
    },
    {
      "parameters": {
        "jsCode": "// å–å¾—ä¸Šæ¸¸ç¯€é»çš„ HTML å…§å®¹\nconst html = $input.first().json.data; \n\n// ğŸš¨ å–å¾—ä¸Šæ¸¸å‚³å…¥çš„ç”¢æ¥­ä»£ç¢¼ (è¨­å®šèµ·å§‹åƒæ•¸ç¯€é»)\nconst industryCode = $input.first().json.industryCode || '';\n\n// 1. ä½¿ç”¨æ­£è¦è¡¨é”å¼å¾ <select> æ¨™ç±¤ä¸­æå–æ‰€æœ‰é ç¢¼å€¼\nconst pageMatches = html.match(/<option value=['\"](\\d+)['\"]\\s*>/g);\n\nlet totalPages = 0;\n\nif (pageMatches && pageMatches.length > 0) {\n    const lastMatch = pageMatches[pageMatches.length - 1]; \n    const pageNumMatch = lastMatch.match(/['\"](\\d+)['\"]/);\n    totalPages = pageNumMatch ? parseInt(pageNumMatch[1], 10) : 0;\n}\n\n// 2. ç”¢ç”Ÿæ‰€æœ‰é é¢çš„ URL Item\nconst urls = [];\nif (totalPages > 0) {\n    for (let i = 1; i <= totalPages; i++) {\n        urls.push({\n            json: {\n                page: i,\n                totalPages: totalPages,\n                industryCode: industryCode // å°‡ç”¢æ¥­ä»£ç¢¼å‚³çµ¦ä¸‹æ¸¸\n            }\n        });\n    }\n}\n\nreturn urls;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -656,
        2416
      ],
      "id": "4fc1f22c-131b-4bc3-9012-6fa1761173b5",
      "name": "è¨ˆç®—ç¸½é æ•¸åŠURL2"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -448,
        2416
      ],
      "id": "de7e0ecb-6601-4d14-a2ed-984778208b69",
      "name": "Loop Over Items5"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 846056814,
          "mode": "list",
          "cachedResultName": "å…¬æœƒ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=846056814"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "å·¥å» åç¨±": "={{ $json.CompanyName[0] }}",
            "COMPANY(TEL)": "={{ $json.Phone[0] }}",
            "URL": "={{ $json.Website[0] }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "å·¥å» åç¨±",
              "displayName": "å·¥å» åç¨±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "EMAIL",
              "displayName": "EMAIL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "URL",
              "displayName": "URL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "COMPANY(TEL)",
              "displayName": "COMPANY(TEL)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        448,
        2688
      ],
      "id": "2b786b87-56ac-4a67-a557-9cef87508c7c",
      "name": "Append row in sheet2",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "fieldToSplitOut": "=CompanyName,Address,Phone,Website,DetailUrl,",
        "include": "selectedOtherFields",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        192,
        2656
      ],
      "id": "af9b59c9-2624-4479-9745-8069e8870b1a",
      "name": "Split Out2"
    },
    {
      "parameters": {
        "url": "https://www.ttpia.org.tw/zh-tw/vendor/all?searchKeyWord=%E5%8F%B0%E5%8C%97",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -544,
        1584
      ],
      "id": "1a755635-4774-490a-a655-abbc3b06a042",
      "name": "å°ç£å¡‘è† å…¬æœƒ"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "name",
              "cssSelector": "div.vendor ul li a",
              "returnArray": true
            },
            {
              "key": "URL",
              "cssSelector": ".vendor ul li a",
              "returnValue": "attribute",
              "attribute": "href",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        608,
        1616
      ],
      "id": "4526ccd5-aca7-400e-84a0-6162fc488a1f",
      "name": "HTML1"
    },
    {
      "parameters": {
        "jsCode": "// ğŸ¯ ç”¢æ¥­é¡åˆ¥å°ç…§è¡¨\nconst industryMap = {\n  '08': 'é£Ÿå“è£½é€ æ¥­',\n  '09': 'é£²æ–™è£½é€ æ¥­',\n  '10': 'è¸è‰è£½é€ æ¥­',\n  '11': 'ç´¡ç¹”æ¥­',\n  '12': 'æˆè¡£åŠæœé£¾å“è£½é€ æ¥­',\n  '13': 'çš®é©ã€æ¯›çš®åŠå…¶è£½å“è£½é€ æ¥­',\n  '14': 'æœ¨ç«¹è£½å“è£½é€ æ¥­',\n  '15': 'ç´™æ¼¿ã€ç´™åŠç´™è£½å“è£½é€ æ¥­',\n  '16': 'å°åˆ·åŠè³‡æ–™å„²å­˜åª’é«”è¤‡è£½æ¥­',\n  '17': 'çŸ³æ²¹åŠç…¤è£½å“è£½é€ æ¥­',\n  '18': 'åŒ–å­¸ææ–™è£½é€ æ¥­',\n  '19': 'åŒ–å­¸è£½å“è£½é€ æ¥­',\n  '20': 'è—¥å“è£½é€ æ¥­',\n  '21': 'æ©¡è† è£½å“è£½é€ æ¥­',\n  '22': 'å¡‘è† è£½å“è£½é€ æ¥­',\n  '23': 'éé‡‘å±¬ç¤¦ç‰©è£½å“è£½é€ æ¥­',\n  '24': 'åŸºæœ¬é‡‘å±¬è£½é€ æ¥­',\n  '25': 'é‡‘å±¬è£½å“è£½é€ æ¥­',\n  '26': 'é›»å­é›¶çµ„ä»¶è£½é€ æ¥­',\n  '27': 'é›»è…¦ã€é›»å­ç”¢å“åŠå…‰å­¸è£½å“è£½é€ æ¥­',\n  '28': 'é›»åŠ›è¨­å‚™è£½é€ æ¥­',\n  '29': 'æ©Ÿæ¢°è¨­å‚™è£½é€ æ¥­',\n  '30': 'æ±½è»ŠåŠå…¶é›¶ä»¶è£½é€ æ¥­',\n  '31': 'å…¶ä»–é‹è¼¸å·¥å…·è£½é€ æ¥­',\n  '32': 'å®¶å…·è£½é€ æ¥­',\n  '33': 'å…¶ä»–è£½é€ æ¥­'\n};\n\n// âœï¸ åªè¦æ”¹é€™è£¡çš„æ•¸å­—å°±å¥½ï¼\nconst industryCode = 31;\n\n// ğŸ¯ è‡ªå‹•æŸ¥è¡¨æ‰¾ä¸­æ–‡\nconst industryName = industryMap[industryCode] || 'æœªåˆ†é¡';\n\nreturn [{\n  json: {\n    industryCode: industryCode,\n    industryName: industryName\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -624,
        -80
      ],
      "id": "febe6be2-0cd4-4114-8a25-15b87d3b542a",
      "name": "ä¿®æ”¹è¡Œæ¥­åˆ¥"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "pageLinks",
              "cssSelector": "select option",
              "returnValue": "attribute",
              "attribute": "value",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        -320,
        1584
      ],
      "id": "7ea53ebc-6987-4bce-8af5-52cdf466f7de",
      "name": "HTML2"
    },
    {
      "parameters": {
        "fieldToSplitOut": "name,URL",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        784,
        1616
      ],
      "id": "19ed28ea-1c75-4cca-8e22-e36191c5be25",
      "name": "Split Out4"
    },
    {
      "parameters": {
        "fieldToSplitOut": "pageLinks",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -128,
        1584
      ],
      "id": "04420e0d-b3d3-44bb-916e-0ad3c2d810b9",
      "name": "Split Out5"
    },
    {
      "parameters": {
        "url": "=https://www.ttpia.org.tw{{ $json.pageLinks }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        400,
        1616
      ],
      "id": "7454af8d-a8ce-4f48-b062-51d8ec395777",
      "name": "å°ç£å¡‘è† å…¬æœƒ1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        80,
        1584
      ],
      "id": "81365f47-b786-41ac-8dc7-247f258b0969",
      "name": "Loop Over Items9"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1184,
        1616
      ],
      "id": "ea7a0d39-dc79-4f68-947b-64be6e1f6584",
      "name": "Wait5",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1201888480,
          "mode": "list",
          "cachedResultName": "å°ç£å¡‘è† è£½å“å·¥æ¥­",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1201888480"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Compant Name": "={{ $json[\"Compant Name\"] }}",
            "Status": "wait"
          },
          "matchingColumns": [
            "Compant Name"
          ],
          "schema": [
            {
              "id": "Compant Name",
              "displayName": "Compant Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Website",
              "displayName": "Website",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å…¬æœƒç¶²å€",
              "displayName": "å…¬æœƒç¶²å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1344,
        1616
      ],
      "id": "cb80b280-2824-41ed-9bb5-75bfb5d54e8d",
      "name": "Update row in sheet3",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1201888480,
          "mode": "list",
          "cachedResultName": "å°ç£å¡‘è† è£½å“å·¥æ¥­",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1201888480"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Compant Name": "={{ $('Split Out4').item.json.name }}",
            "å…¬æœƒç¶²å€": "=https://www.ttpia.org.tw{{ $('Split Out4').item.json.URL }}",
            "Status": "no"
          },
          "matchingColumns": [
            "Status"
          ],
          "schema": [
            {
              "id": "Compant Name",
              "displayName": "Compant Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "è² è²¬äºº",
              "displayName": "è² è²¬äºº",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Website",
              "displayName": "Website",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å…¬æœƒç¶²å€",
              "displayName": "å…¬æœƒç¶²å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        976,
        1616
      ],
      "id": "3b0b9757-3c0a-4e84-83ea-0195762ed5db",
      "name": "Append row in sheet3",
      "executeOnce": false,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "content": "å°ç£å¡‘è† è£½å“å…¬æœƒ\nå…ˆæœå°‹ æ¯å€‹å·¥å» çš„ å…¬æœƒç¶²å€\nå†å» sheet ç”¨å…¬å¼é€²å…¥å·¥å»  ç¶²å€ çˆ¬å–æ‰€éœ€è³‡æ–™ä¸‹ä¾†\n",
        "height": 336,
        "width": 2784
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1088,
        1520
      ],
      "typeVersion": 1,
      "id": "1a971cb8-6cc3-4d3e-9a75-ee4d9f93291c",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "url": "https://www.tmdia.org.tw/api/Index",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "category",
              "value": "A,B,C,D,E,F,G,H,I,J"
            },
            {
              "name": "area"
            },
            {
              "name": "oversea"
            },
            {
              "name": "atype",
              "value": "C"
            },
            {
              "name": "lang",
              "value": "tw"
            },
            {
              "name": "page",
              "value": "={{ $json.page }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "application/json, text/plain, */*"
            },
            {
              "name": "accept-language",
              "value": "zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7"
            },
            {
              "name": "priority",
              "value": "u=1, i"
            },
            {
              "name": "referer",
              "value": "https://www.tmdia.org.tw/Members/"
            },
            {
              "name": "sec-ch-ua",
              "value": "\"Chromium\";v=\"142\", \"Google Chrome\";v=\"142\", \"Not_A Brand\";v=\"99\""
            },
            {
              "name": "sec-ch-ua-mobile",
              "value": "?0"
            },
            {
              "name": "sec-ch-ua-platform",
              "value": "\"Windows\""
            },
            {
              "name": "sec-fetch-dest",
              "value": "empty"
            },
            {
              "name": "sec-fetch-mode",
              "value": "cors"
            },
            {
              "name": "sec-fetch-site",
              "value": "same-origin"
            },
            {
              "name": "user-agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"
            },
            {
              "name": "cookie",
              "value": "user2=232;"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        }
      },
      "name": "æ¨¡å…·å·¥æ¥­å…¬æœƒ",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        2496,
        1648
      ],
      "typeVersion": 4.1,
      "id": "722f2297-587f-4495-a63c-bf4d7f7709c6",
      "notes": "å…ˆè¨ªå•é¦–é ï¼Œè®“ WAF èªç‚ºæ˜¯æ­£å¸¸è¨ªå®¢"
    },
    {
      "parameters": {
        "jsCode": "// è¨­å®šè¦çˆ¬å–çš„é æ•¸ï¼ˆå¾ç¬¬1é åˆ°ç¬¬11é ï¼‰\nconst totalPages = 43;\nconst pages = [];\n\nfor (let i = 1; i <= totalPages; i++) {\n  pages.push({\n    json: {\n      page: i\n    }\n  });\n}\n\nreturn pages;"
      },
      "name": "å»ºç«‹é ç¢¼åˆ—è¡¨1",
      "type": "n8n-nodes-base.code",
      "position": [
        1888,
        1632
      ],
      "typeVersion": 2,
      "id": "aed82f1a-0dab-4464-92c2-62a89817ff0f"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1056249680,
          "mode": "list",
          "cachedResultName": "æ¨¡å…·å·¥æ¥­",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1056249680"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.company }}",
            "web": "={{ $json.website }}",
            "email": "={{ $json.email }}",
            "åœ°å€": "={{ $json.address }}",
            "telephone": "={{ $json.phone }}",
            "status(æœå°‹)": "ready",
            "ç¶²ç«™(ä¾†æº)": "=https://www.tmdia.org.tw/members/page={{ $json.source_page }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3168,
        1648
      ],
      "id": "47048725-1450-4979-b512-bd61b42146d4",
      "name": "Append row in sheet4",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "jsCode": "// 1. å–å¾— n8n å‚³å…¥çš„åŸå§‹ç‰©ä»¶\nconst root = items[0].json;\n\n// 2. æ‰¾å‡º \"data\" æ¬„ä½\n// æ ¹æ“šæ‚¨æä¾›çš„è³‡æ–™ï¼Œå®ƒå«åš \"data\" ä¸”å…§å®¹æ˜¯å­—ä¸²\nlet rawString = root.data || root.body;\n\n// 3. \"è§£å£“ç¸®\"ï¼šæŠŠå­—ä¸²è®ŠæˆçœŸæ­£çš„ç‰©ä»¶\nlet parsedData = {};\n\n// å¦‚æœå®ƒæ˜¯å­—ä¸²ï¼Œå°± parse å®ƒ\nif (typeof rawString === 'string') {\n    try {\n        parsedData = JSON.parse(rawString);\n    } catch (e) {\n        return [{ json: { error: \"JSON è§£æå¤±æ•—\", raw: rawString } }];\n    }\n} else if (typeof rawString === 'object') {\n    // å¦‚æœå®ƒå·²ç¶“æ˜¯ç‰©ä»¶ (æœ‰æ™‚å€™ API è¡Œç‚ºæœƒè®Š)ï¼Œå°±ç›´æ¥ç”¨\n    parsedData = rawString;\n} else {\n    // è¬ä¸€å®Œå…¨æ‰¾ä¸åˆ°\n    parsedData = root; \n}\n\n// 4. é–å®šç›®æ¨™é™£åˆ— (Member)\n// ç¾åœ¨ parsedData æ˜¯ä¸€å€‹ä¹¾æ·¨çš„ç‰©ä»¶äº†ï¼Œæˆ‘å€‘å¯ä»¥æ‹¿ member äº†\nconst members = parsedData.member || parsedData.Data || [];\n\nif (!Array.isArray(members)) {\n    return [{ \n        json: { \n            error: \"æ‰¾ä¸åˆ° member é™£åˆ—\", \n            debug_parsed: parsedData \n        } \n    }];\n}\n\n// 5. è‡ªå‹•æ‹†åˆ† (Split Out)\nreturn members.map(item => {\n    return {\n        json: {\n            company: item.company,\n            phone: item.tel,\n            address: item.address,\n            products: item.product,\n            email: item.email,\n            website: item.website,\n            capital: item.capital,\n            employee_count: item.employee,\n            \n            // è¨˜éŒ„ä¾†æºé ç¢¼ï¼Œæ–¹ä¾¿ä¹‹å¾Œæª¢æŸ¥\n            source_page: parsedData.page,\n            \n            // ä¿ç•™å®Œæ•´åŸå§‹è³‡æ–™\n            _raw: item\n        }\n    };\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2816,
        1648
      ],
      "id": "a35c1005-475b-497f-b16c-7a4168405835",
      "name": "Code in JavaScript6"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2192,
        1632
      ],
      "id": "80774fe2-2ea7-4185-9969-073935e361fc",
      "name": "Loop Over Items6"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me2",
      "typeVersion": 1,
      "position": [
        3616,
        1648
      ],
      "id": "cb37672c-6d8f-4de8-ae09-d873cf3222e8"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        3376,
        1648
      ],
      "id": "06a27b3f-e7c8-4a22-986a-79a8199d59d4",
      "name": "Wait4",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "jsCode": "// å‡è¨­ä¸Šä¸€æ­¥ HTTP Request çš„è¼¸å‡ºåœ¨ $json è®Šæ•¸ä¸­\n// $json.data æ˜¯ä¸€å€‹åŒ…å« JSON æ ¼å¼çš„å­—ä¸²\nconst dataString = $json.data;\n\n// ä½¿ç”¨ JSON.parse() é€²è¡Œç¬¬ä¸€æ¬¡è§£æ\nconst parsedOuterData = JSON.parse(dataString);\n\n// å¯¦éš›çš„æœƒå“¡åˆ—è¡¨ä½æ–¼ parsedOuterData.data è£¡é¢\nconst memberList = parsedOuterData.data;\n\n// å°‡æœƒå“¡åˆ—è¡¨ (memberList) ä½œç‚ºæ–°çš„è¼¸å‡ºå›å‚³\n// é€™æ¨£ä¸‹ä¸€å€‹ç¯€é»å°±èƒ½ç›´æ¥è™•ç†æ¯ä¸€ç­†æœƒå“¡è³‡æ–™äº†\nreturn memberList.map(member => ({\n    json: member.content\n}));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        2016
      ],
      "id": "dac8f324-12f0-456a-9e7e-d98f2f465f72",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "jsCode": "// è¨­å®šè¦çˆ¬å–çš„é æ•¸ï¼ˆå¾ç¬¬1é åˆ°ç¬¬11é ï¼‰\nconst totalPages = 11;\nconst pages = [];\n\nfor (let i = 1; i <= totalPages; i++) {\n  pages.push({\n    json: {\n      page: i\n    }\n  });\n}\n\nreturn pages;"
      },
      "name": "å»ºç«‹é ç¢¼åˆ—è¡¨2",
      "type": "n8n-nodes-base.code",
      "position": [
        -800,
        1920
      ],
      "typeVersion": 2,
      "id": "ca843b28-f79a-466e-83f0-ff91b5ee785a"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1852860728,
          "mode": "list",
          "cachedResultName": "çµ²ç¹”å·¥æ¥­å…¬æœƒ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1852860728"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "åœ°å€": "={{ $json[\"å…¬å¸åœ°å€_ä¸­\"] }}",
            "Company_Name": "={{ $json[\"å…¬å¸åç¨±_ä¸­\"] }}",
            "email": "={{ $json.EMAIL }}",
            "web": "={{ $json[\"ç¶²ç«™\"] }}",
            "telephone": "={{ $json[\"å…¬å¸é›»è©±\"] }}",
            "status(æœå°‹)": "ready",
            "ç¶²ç«™(ä¾†æº)": "=https://www.filaweaving.org.tw/list/member-information.htm#/{{ $json[\"æœƒå“¡ç·¨è™Ÿ\"] }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        192,
        2016
      ],
      "id": "b7a4643a-9ddb-4d5e-8163-db07c3045a88",
      "name": "Append row in sheet5",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -576,
        1920
      ],
      "id": "d2adb2c9-6dbf-47f0-af2b-9b8eada87100",
      "name": "Loop Over Items7"
    },
    {
      "parameters": {
        "url": "https://www.filaweaving.org.tw/index.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "s",
              "value": "xls_import"
            },
            {
              "name": "a",
              "value": "fetch"
            },
            {
              "name": "limit",
              "value": "15"
            },
            {
              "name": "pages",
              "value": "11"
            },
            {
              "name": "page",
              "value": "={{ $('å»ºç«‹é ç¢¼åˆ—è¡¨2').item.json.page }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"
            },
            {
              "name": "Referer",
              "value": "https://www.filaweaving.org.tw/list/member-information.htm"
            },
            {
              "name": "Accept",
              "value": "*/*"
            },
            {
              "name": "X-Requested-With",
              "value": "XMLHttpRequest"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -256,
        2016
      ],
      "id": "f4de9ea1-4128-4d18-a9a8-98211dce64db",
      "name": "çµ²ç¹”å…¬æœƒ1"
    },
    {
      "parameters": {
        "content": "æ¨¡å…·å…¬æœƒ\n",
        "height": 560,
        "width": 2160
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1744,
        1472
      ],
      "typeVersion": 1,
      "id": "0cdfd6f2-6cd3-4c67-b0ce-42d339691238",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "çµ²ç¹”å…¬æœƒ\n",
        "height": 448,
        "width": 1504
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1088,
        1888
      ],
      "typeVersion": 1,
      "id": "b893287e-7651-4d60-90a5-e14c3bba3a1d",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "##æ‰‹å·¥å…·å·¥æ¥­å…¬æœƒ  æœªçˆ¬å–Ë‹æˆåŠŸ",
        "height": 560,
        "width": 2512,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1296,
        2384
      ],
      "typeVersion": 1,
      "id": "7a28ade3-9530-43f1-b6f7-c6d047afbebd",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "jsCode": "// è¨­å®šè¦çˆ¬å–çš„é æ•¸ï¼ˆå¾ç¬¬1é åˆ°ç¬¬11é ï¼‰\nconst totalPages = 17;\nconst pages = [];\n\nfor (let i = 1; i <= totalPages; i++) {\n  pages.push({\n    json: {\n      page: i\n    }\n  });\n}\n\nreturn pages;"
      },
      "name": "å»ºç«‹é ç¢¼åˆ—è¡¨",
      "type": "n8n-nodes-base.code",
      "position": [
        -1168,
        2688
      ],
      "typeVersion": 2,
      "id": "d676d3be-7548-4b7c-aa47-9c0002e8a117"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://stge.moenv.gov.tw/gasstation/website/opendata.aspx",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -832,
        3136
      ],
      "id": "a331f1ff-35f1-4ea4-a6e8-32282c16fb4b",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "company",
              "cssSelector": "#ctl00_RightContent_ddlGsm option",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        -352,
        3136
      ],
      "id": "c8bc70ff-5f59-43e0-b6a1-a02aedca5aec",
      "name": "HTML3"
    },
    {
      "parameters": {
        "fieldToSplitOut": "company",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -96,
        3136
      ],
      "id": "313e8205-69c2-4d18-acf7-978532c8e884",
      "name": "Split Out3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "804c9bc4-ddb2-4048-96de-a7de2195ebac",
              "leftValue": "={{ $json.company }}",
              "rightValue": "åŠ æ²¹ç«™",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "63e66438-4397-4e1c-a5e2-7caca19ab5f9",
              "leftValue": "={{ $json.company }}",
              "rightValue": "è‡ºåŒ—å¤§çœ¾",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "42652e12-af26-4db4-92e3-4b1106510fc0",
              "leftValue": "={{ $json.company }}",
              "rightValue": "å…¨åœ‹",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "74f3bab7-4f58-4c2e-a594-549c3c72a585",
              "leftValue": "={{ $json.company }}",
              "rightValue": "æ”¿åºœ",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "2d07fe90-c49d-4531-9b0b-ba37c04ed561",
              "leftValue": "={{ $json.company }}",
              "rightValue": "ä¸­è¯é›»ä¿¡",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "24b09b94-65ed-4197-a909-d1616e7b9471",
              "leftValue": "={{ $json.company }}",
              "rightValue": "éµè·¯",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "512fd870-ef2a-4a04-ad99-450c2521a91f",
              "leftValue": "={{ $json.company }}",
              "rightValue": "ä¸­æ²¹",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "5392290f-0542-44ca-bc34-251f3494698b",
              "leftValue": "={{ $json.company }}",
              "rightValue": "è‡ªä¾†æ°´",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "38c21758-c8b2-4178-b471-200465c452b1",
              "leftValue": "={{ $json.company }}",
              "rightValue": "æ·é‹",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "c8b61c83-bc52-47bd-8285-18d38ec44a2c",
              "leftValue": "={{ $json.company }}",
              "rightValue": "æŠ½æ°´ç«™",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        128,
        3136
      ],
      "id": "7cb07cca-096c-40e0-898d-bbe31dcc7825",
      "name": "If"
    },
    {
      "parameters": {
        "jsCode": "return items.slice(1, 1001);"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        352,
        3152
      ],
      "id": "f1a25285-a2bc-4981-a2ab-d2759cdea6f4",
      "name": "è™•ç†nç­†"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1578026346,
          "mode": "list",
          "cachedResultName": "å„²æ§½",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1578026346"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.Company_Name }}",
            "status(æœå°‹)": "ready",
            "row_number": 0
          },
          "matchingColumns": [
            "Company_Name"
          ],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        992,
        3152
      ],
      "id": "cd07cbdc-45c6-4db1-a009-0b416fafb293",
      "name": "Update row in sheet1",
      "alwaysOutputData": true,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1578026346,
          "mode": "list",
          "cachedResultName": "å„²æ§½",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1578026346"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.company }}",
            "status(æœå°‹)": "no"
          },
          "matchingColumns": [
            "status(æœå°‹)"
          ],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        672,
        3152
      ],
      "id": "67c764a1-52fc-4b67-8c32-5061b234d72c",
      "name": "Append or update row in sheet",
      "alwaysOutputData": true,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "content": "å„²æ§½ç³»çµ±\n",
        "height": 304,
        "width": 2544
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1296,
        3056
      ],
      "typeVersion": 1,
      "id": "b1f85a35-debb-499b-9a73-748a90f4437d",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "jsCode": "// ä¸éœ€è¦ require 'iconv-lite'ï¼Œç›´æ¥ä½¿ç”¨å…§å»ºåŠŸèƒ½\nconst decoder = new TextDecoder('big5');\n\n// éæ­·æ‰€æœ‰é€²ä¾†çš„è³‡æ–™\nfor (const item of $input.all()) {\n  \n  // è¨˜å¾—ï¼šä½ åœ¨ä¸Šä¸€å€‹ HTTP Request ç¯€é»ï¼Œå¿…é ˆæŠŠå›æ‡‰æ ¼å¼è¨­ç‚º \"File\" æˆ– \"Binary\"\n  // é è¨­çš„ binary å±¬æ€§åç¨±é€šå¸¸æ˜¯ 'data'\n  const binaryData = item.binary.data;\n\n  if (binaryData) {\n    // 1. å°‡ n8n çš„ Base64 è³‡æ–™è½‰æˆ Buffer\n    const buffer = Buffer.from(binaryData.data, 'base64');\n\n    // 2. ä½¿ç”¨å…§å»ºè§£ç¢¼å™¨è½‰æˆæ–‡å­—\n    const decodedString = decoder.decode(buffer);\n\n    // 3. æŠŠè§£ç¢¼å¾Œçš„ä¸­æ–‡æ”¾å› JSON è£¡é¢\n    item.json.decodedContent = decodedString;\n    \n    // ç‚ºäº†æ–¹ä¾¿ä¸‹ä¸€å€‹ HTML ç¯€é»æŠ“å–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è“‹æ‰åŸæœ¬çš„ data æ¬„ä½ (è¦–ä½ çš„éœ€æ±‚è€Œå®š)\n    item.json.data = decodedString; \n  }\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -624,
        3136
      ],
      "id": "2510164c-a41a-4685-a992-d5a08429f25c",
      "name": "å…ˆè§£ç¢¼(å› ç‚ºæœƒæœ‰äº‚ç¢¼)"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "Industry",
              "cssSelector": "div.member_class a",
              "returnArray": true
            },
            {
              "key": "Industry_URL",
              "cssSelector": "div.member_class a",
              "returnValue": "attribute",
              "attribute": "href",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        448,
        3488
      ],
      "id": "3b2a8792-d9e0-4c27-97b7-44ab6cf986f0",
      "name": "HTML"
    },
    {
      "parameters": {
        "fieldToSplitOut": "Industry,Industry_URL",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        656,
        3488
      ],
      "id": "55b85efa-0f59-4214-9653-805cbdaaae73",
      "name": "Split Out"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://www.tpca.org.tw/Industry/PagingMember",
        "sendBody": true,
        "contentType": "form-urlencoded",
        "bodyParameters": {
          "parameters": [
            {
              "name": "mid",
              "value": "819"
            },
            {
              "name": "itemid",
              "value": "1"
            },
            {
              "name": "industryitemid",
              "value": "1"
            },
            {
              "name": "Limit",
              "value": "100"
            },
            {
              "name": "NowPage",
              "value": "1"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        128,
        3680
      ],
      "id": "8401f936-8d07-4a61-b72a-13701e6cf3a2",
      "name": "HTTP Request2"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        864,
        3488
      ],
      "id": "41f89bea-5d3f-4202-a6d1-f0ae5e605f09",
      "name": "Loop Over Items2"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "dataPropertyName": "HtmlStr",
        "extractionValues": {
          "values": [
            {
              "key": "member_id",
              "cssSelector": "a.todetail",
              "returnValue": "attribute",
              "attribute": "index",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        544,
        3680
      ],
      "id": "bdcebc17-b63d-4310-93bb-26c1466d7dc7",
      "name": "HTML4"
    },
    {
      "parameters": {
        "fieldToSplitOut": "rows",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        336,
        3680
      ],
      "id": "5215c791-986e-4270-b290-5ab520b42f1f",
      "name": "Split Out6"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        720,
        3680
      ],
      "id": "eedc635f-6c74-4896-9f4d-b72b077f5c9d",
      "name": "Loop Over Items4"
    },
    {
      "parameters": {
        "url": "=https://www.tpca.org.tw/Industry/Detail?memberid={{ $json.member_id }}&mid=819&itemid=1",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        944,
        3760
      ],
      "id": "e751fc9b-d4ad-4b28-9fb5-7e7df080aa41",
      "name": "HTTP Request3"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "email",
              "cssSelector": "div.table-cell",
              "returnArray": true
            },
            {
              "key": "name",
              "cssSelector": "h2.page_title",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        1184,
        3776
      ],
      "id": "95f702e5-1242-4f44-93b4-1c9bfedfb300",
      "name": "HTML5"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1987595396,
          "mode": "list",
          "cachedResultName": "é›»è·¯æ¿",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1987595396"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.name[0] }}",
            "åœ°å€": "={{ $json.email[5] }}",
            "telephone": "={{ $json.email[1] }}",
            "status(æœå°‹)": "ready",
            "email": "={{ $json.email[13] }}",
            "web": "={{ $json.email[9] }}",
            "çˆ¬å–time": "={{ $now }}",
            "ç¶²ç«™(ä¾†æº)": "=https://www.tpca.org.tw/Industry/Detail?memberid={{ $('Loop Over Items4').item.json.member_id[0] }}&mid=819&itemid=1"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1392,
        3776
      ],
      "id": "8ff74f39-8e89-40ca-9cec-528a271cdf92",
      "name": "Append row in sheet1",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://www.tpca.org.tw/Industry?mid=819&itemid=1",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        240,
        3488
      ],
      "id": "dee954be-0748-4e22-be93-e4c3e8743638",
      "name": "TPCDé›»è·¯æ¿"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "html_list",
              "cssSelector": "tr[onclick]",
              "returnValue": "html",
              "returnArray": true
            },
            {
              "key": "id_attr_list",
              "cssSelector": "tr[onclick]",
              "returnValue": "attribute",
              "attribute": "onclick",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        -208,
        4272
      ],
      "id": "f294583c-dc3a-4f47-8c6a-414bfc13d542",
      "name": "Step 1: åŸå§‹ç¢¼èˆ‡å±¬æ€§"
    },
    {
      "parameters": {
        "jsCode": "// å–å¾—ä¸Šä¸€æ­¥é©ŸæŠ“åˆ°çš„å…©å€‹é™£åˆ—\nconst data = items[0].json;\nconst htmlList = data.html_list || [];\nconst idList = data.id_attr_list || [];\n\nconst results = [];\n\nfor (let i = 0; i < htmlList.length; i++) {\n  \n  // 1. è™•ç† ID (å¾ onclick å­—ä¸²ä¸­æŠ“æ•¸å­—)\n  let cleanId = \"\";\n  if (idList[i]) {\n     const match = idList[i].match(/\\d+/);\n     if (match) cleanId = match[0];\n  }\n\n  // 2. é—œéµå‹•ä½œï¼šæŠŠ ID å¡é€² HTML æ¨™ç±¤è£¡ï¼\n  // é€™æ¨£ä¸‹ä¸€å€‹ç¯€é»åœ¨è§£æ HTML æ™‚ï¼Œå°±å¯ä»¥é †ä¾¿æŠŠ ID æŠ“å›ä¾†\n  const fixedHtml = \"<table><tr data-id='\" + cleanId + \"'>\" + htmlList[i] + \"</tr></table>\";\n  \n  results.push({\n    json: {\n      html_for_parsing: fixedHtml\n    }\n  });\n}\n\nreturn results;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        4272
      ],
      "id": "79911aec-d706-4a34-ab53-9a843f8178e6",
      "name": "Step 2: æ³¨å…¥ ID åˆ° HTML"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "dataPropertyName": "html_for_parsing",
        "extractionValues": {
          "values": [
            {
              "key": "member",
              "cssSelector": "tr:first-of-type > td:nth-child(1)"
            },
            {
              "key": "contact",
              "cssSelector": "tr:first-of-type > td:last-child"
            },
            {
              "key": "company_id",
              "cssSelector": "tr:first-of-type",
              "returnValue": "attribute",
              "attribute": "data-id"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        192,
        4272
      ],
      "id": "42628a53-8e24-4faf-b7bf-38c04f4f3fc5",
      "name": "Step 3: è§£æ ID èˆ‡å…§å®¹"
    },
    {
      "parameters": {
        "url": "http://www.taiwanbattery.org.tw/member/memberlist",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -416,
        4272
      ],
      "id": "8fe0da0f-caa9-4c71-bb67-6cfcb6897ab5",
      "name": "é›»æ± å…¬æœƒ3"
    },
    {
      "parameters": {
        "jsCode": "// æœ€çµ‚æ¸…æ´—ï¼šå»ç©ºç™½ã€éæ¿¾\nconst results = [];\n\nitems.forEach(item => {\n  const data = item.json;\n  \n  // æ¸…ç†æ–‡å­—å‡½å¼\n  const cleanText = (text) => {\n    if (!text) return \"\";\n    return text.replace(/\\s+/g, ' ').trim();\n  };\n\n  let member = cleanText(data.member);\n  let contact = cleanText(data.contact);\n  let id = data.company_id;\n\n  // éæ¿¾ç„¡æ•ˆè³‡æ–™\n  if (member || contact) {\n    results.push({\n      json: {\n        company_id: id,\n        member: member,\n        contact: contact\n      }\n    });\n  }\n});\n\nreturn results;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        384,
        4272
      ],
      "id": "aaf349da-c331-4d31-b338-f6a90ed63b4d",
      "name": "Step 4: æœ€çµ‚æ¸…æ´—2"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me3",
      "typeVersion": 1,
      "position": [
        1104,
        4496
      ],
      "id": "5d93d565-575e-4a85-a02d-3e0b97c70df7"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 639187394,
          "mode": "list",
          "cachedResultName": "é›»æ± å…¬æœƒ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=639187394"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.member }}",
            "çˆ¬å–time": "={{ $now }}",
            "ç¶²ç«™(ä¾†æº)": "={{ $json.company_id }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        800,
        4368
      ],
      "id": "beda9611-8049-4bde-84ca-bce811de8813",
      "name": "Append row in sheet6",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "url": "=http://www.taiwanbattery.org.tw/member/company/{{ $json['ç¶²ç«™(ä¾†æº)'] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -192,
        4688
      ],
      "id": "59795eb9-6ec1-4b17-aa0f-5d6644d56893",
      "name": "é›»æ± å…¬æœƒ4"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 639187394,
          "mode": "list",
          "cachedResultName": "é›»æ± å…¬æœƒ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=639187394"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -608,
        4608
      ],
      "id": "ca3c4a73-cbd3-46e2-8847-20ca89741f21",
      "name": "Get row(s) in sheet2",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -400,
        4608
      ],
      "id": "78f44753-05ec-4535-a7cd-f2e9bfa8bc45",
      "name": "Loop Over Items10"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me4",
      "typeVersion": 1,
      "position": [
        800,
        4832
      ],
      "id": "aa3c8dfe-e484-4b4a-a1d4-0e0308397958"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "web",
              "cssSelector": "td",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        112,
        4688
      ],
      "id": "4c0dd002-359b-41e5-a2c3-a3a052727a04",
      "name": "Step 1: åŸå§‹ç¢¼èˆ‡å±¬æ€§1"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 825314960,
          "mode": "list",
          "cachedResultName": "ç¸½å·¥å» æ•¸é‡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=825314960"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.web[1] }}",
            "web": "={{ $json.web[13].split(\" \")[0] }}",
            "åœ°å€": "={{ $json.web[5] }}",
            "telephone": "={{ $json.web[9] }}",
            "status(æœå°‹)": "ready",
            "çˆ¬å–time": "={{ $now }}",
            "email": "={{ $json.web[19] }}"
          },
          "matchingColumns": [
            "Company_Name"
          ],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        320,
        4688
      ],
      "id": "b5d062fc-00db-4759-992c-c8faedd63108",
      "name": "Update row in sheet4",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        528,
        4688
      ],
      "id": "5250a18f-4c7c-4f52-889f-4b3174195678",
      "name": "Wait2",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1600,
        3776
      ],
      "id": "42f18034-6f08-448d-b1e3-530b7a9247de",
      "name": "Wait6",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "content": "é›»è·¯æ¿",
        "height": 640,
        "width": 2032
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -256,
        3440
      ],
      "typeVersion": 1,
      "id": "897336fd-0bc9-42e0-aeec-744bd19ea36e",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "é›»æ± \n",
        "height": 912,
        "width": 2320,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -752,
        4224
      ],
      "typeVersion": 1,
      "id": "c7cc9935-8ebd-47d8-a2ed-ed3cd4e2a2a5",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "jsCode": "// å®šç¾©è¦çˆ¬å–çš„æ‰€æœ‰ URLï¼ˆåŒ…å«åˆ†é ï¼‰\nconst urls = [\n  // å…ƒä»¶è£½é€ \n  { category: 'å…ƒä»¶è£½é€ ', url: 'https://www.tpcia.org.tw/ç”¢å“è³‡è¨Š/å…ƒä»¶è£½é€ ' },\n  { category: 'å…ƒä»¶è£½é€ ', url: 'https://www.tpcia.org.tw/ç”¢å“è³‡è¨Š/å…ƒä»¶è£½é€ ?page=2' },\n  // ææ–™å» \n  { category: 'ææ–™å» ', url: 'https://www.tpcia.org.tw/ç”¢å“è³‡è¨Š/ææ–™å» ' },\n  { category: 'ææ–™å» ', url: 'https://www.tpcia.org.tw/ç”¢å“è³‡è¨Š/ææ–™å» ?page=2' },\n  // è¨­å‚™å» \n  { category: 'è¨­å‚™å» ', url: 'https://www.tpcia.org.tw/ç”¢å“è³‡è¨Š/è¨­å‚™å» ' },\n  { category: 'è¨­å‚™å» ', url: 'https://www.tpcia.org.tw/ç”¢å“è³‡è¨Š/è¨­å‚™å» ?page=2' },\n  // é€šè·¯/ä»£ç†/å…¶ä»–\n  { category: 'é€šè·¯/ä»£ç†/å…¶ä»–', url: 'https://www.tpcia.org.tw/ç”¢å“è³‡è¨Š/é€šè·¯-ä»£ç†-å…¶ä»–' },\n  { category: 'é€šè·¯/ä»£ç†/å…¶ä»–', url: 'https://www.tpcia.org.tw/ç”¢å“è³‡è¨Š/é€šè·¯-ä»£ç†-å…¶ä»–?page=2' },\n];\n\nreturn urls.map(item => ({ json: item }));"
      },
      "id": "d7c92444-3b5b-478e-bb6a-21d4c2c6992f",
      "name": "è¨­å®šæ‰€æœ‰ URL",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -256,
        5280
      ]
    },
    {
      "parameters": {
        "jsCode": "// å–å¾— HTML å…§å®¹å’Œåˆ†é¡\nconst html = $input.first().json.data;\nconst category = $input.first().json.category;\n\n// æ‰¾å‡ºæ‰€æœ‰å…¬å¸\nconst results = [];\n\n// æ–¹æ³•ï¼šç”¨æ­£å‰‡æ‰¾ pro_in1 å€å¡Šå…§çš„é€£çµ\nconst pattern = /<a[^>]+href=\"(https:\\/\\/www\\.tpcia\\.org\\.tw\\/[^\"]+)\"[^>]*title=\"([^\"]+)\"/g;\n\nlet match;\nwhile ((match = pattern.exec(html)) !== null) {\n  // æ’é™¤åˆ†é é€£çµå’Œéå…¬å¸é€£çµ\n  const url = match[1];\n  const name = match[2];\n  \n  // åªè¦åŒ…å«ã€Œå…¬å¸ã€æˆ–ã€Œæœ‰é™å…¬å¸ã€çš„æ‰æ˜¯å…¬å¸\n  if (name.includes('å…¬å¸') || name.includes('Corp') || name.includes('Ltd')) {\n    // é¿å…é‡è¤‡\n    if (!results.find(r => r.companyUrl === url)) {\n      results.push({\n        category: category,\n        companyName: name,\n        companyUrl: url\n      });\n    }\n  }\n}\n\nreturn results.map(r => ({ json: r }));"
      },
      "id": "2f77b72c-54b9-47fc-bf46-53a5e03c0cfb",
      "name": "è§£æ HTML å–å¾—å…¬å¸",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        624,
        5280
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        16,
        5280
      ],
      "id": "852eef16-c0b4-478e-9661-45eabdbd9eea",
      "name": "Loop Over Items8"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 368568889,
          "mode": "list",
          "cachedResultName": "è¢«å‹•å…ƒä»¶",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=368568889"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.companyName }}",
            "web": "={{ $json.companyUrl }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡æ¬¡æ•¸",
              "displayName": "å¯„ä¿¡æ¬¡æ•¸",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        832,
        5280
      ],
      "id": "f2a06356-47d7-4ddc-903a-0c3bafc0f256",
      "name": "Append row in sheet7",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1072,
        5344
      ],
      "id": "ea36f0ec-7d79-4481-998d-5c2023b98879",
      "name": "Wait7",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text"
            }
          }
        }
      },
      "id": "778368df-b436-44a3-9ca1-5b575fe6efaa",
      "name": "è¢«å‹•å…ƒä»¶ç¬¬ä¸€é ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        336,
        5280
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 368568889,
          "mode": "list",
          "cachedResultName": "è¢«å‹•å…ƒä»¶",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=368568889"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "status(æœå°‹)",
              "lookupValue": "wait"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -448,
        5664
      ],
      "id": "f73385ee-ca2b-4503-b34c-218e5f8063fc",
      "name": "Get row(s) in sheet3",
      "executeOnce": true,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -192,
        5664
      ],
      "id": "a60383d8-7b07-4570-a56d-27c92227d978",
      "name": "Loop Over Items11"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me1",
      "typeVersion": 1,
      "position": [
        1152,
        5824
      ],
      "id": "75633fc1-228d-43aa-b5c1-f191d96bdefd"
    },
    {
      "parameters": {
        "url": "={{ $json['ç¶²ç«™(ä¾†æº)'] }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text"
            }
          }
        }
      },
      "id": "533dd594-312a-47d2-95f3-b53591d24262",
      "name": "è¢«å‹•å…ƒä»¶ç¬¬äºŒé ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        96,
        5664
      ]
    },
    {
      "parameters": {
        "jsCode": "// ========== è§£æå…¬å¸è©³ç´°é é¢ ==========\n// æå–ï¼šé›»è©±ã€å…¬å¸ç¶²å€ã€E-mail\n\nconst html = $input.first().json.data;\nconst category = $input.first().json.category;\nconst companyName = $input.first().json.companyName;\nconst companyUrl = $input.first().json.companyUrl;\n\n// åˆå§‹åŒ–çµæœ\nlet phone = '';\nlet website = '';\nlet email = '';\nlet fax = '';\nlet contactPerson = '';\n\n// ===== æ–¹æ³•1ï¼šå¾è¡¨æ ¼ä¸­æå– =====\n\n// é›»è©±ï¼šæ‰¾ã€Œé›»è©±ã€å¾Œé¢çš„å…§å®¹\nconst phonePattern = /é›»è©±[\\s\\S]*?(0\\d{1,2}-\\d{6,8})/;\nconst phoneMatch = html.match(phonePattern);\nif (phoneMatch) {\n  phone = phoneMatch[1].replace(/<[^>]+>/g, '').trim();\n}\n\n// å‚™ç”¨æ–¹æ³•ï¼šç›´æ¥æ‰¾é›»è©±è™Ÿç¢¼æ ¼å¼\nif (!phone) {\n  const phonePattern = /(?:é›»è©±|TEL|Tel)[ï¼š:\\s]*([0-9\\-\\s]+)/i;\n  const altPhoneMatch = html.match(phonePattern);\n  if (altPhoneMatch) {\n    phone = altPhoneMatch[1].trim();\n  }\n}\n\n// å‚³çœŸ\nconst faxMatch = html.match(/å‚³çœŸ<\\/span>.*?<\\/td>.*?<td[^>]*>.*?<p>.*?([0-9\\-]+)/s);\nif (faxMatch) {\n  fax = faxMatch[1].trim();\n}\n\n// å…¬å¸ç¶²å€ï¼šæ‰¾ href é€£çµ\nconst websiteMatch = html.match(/å…¬å¸ç¶²å€<\\/span>.*?<a href=\"([^\"]+)\"/s);\nif (websiteMatch) {\n  website = websiteMatch[1].trim();\n}\n\n// E-mailï¼šæ‰¾ email æ ¼å¼\nconst emailPattern = /E-mail[ï¼š:\\s]*([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})/gi;\nconst emailMatches = html.match(emailPattern);\nif (emailMatches && emailMatches.length > 0) {\n  // å–ç¬¬ä¸€å€‹ email\n  const fullMatch = emailMatches[0];\n  const emailOnly = fullMatch.match(/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})/);\n  if (emailOnly) {\n    email = emailOnly[1].trim();\n  }\n}\n\n// å‚™ç”¨æ–¹æ³•ï¼šç›´æ¥æ‰¾æ‰€æœ‰ email æ ¼å¼\nif (!email) {\n  const generalEmailPattern = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/g;\n  const allEmails = html.match(generalEmailPattern);\n  if (allEmails && allEmails.length > 0) {\n    // éæ¿¾æ‰ç³»çµ± email\n    const validEmails = allEmails.filter(e => \n      !e.includes('example.com') && \n      !e.includes('hcaptcha') &&\n      !e.includes('google')\n    );\n    if (validEmails.length > 0) {\n      email = validEmails[0];\n    }\n  }\n}\n\n// æ¥­å‹™çª—å£å§“å\nconst contactMatch = html.match(/å§“å[ï¼š:]\\s*([^<\\n]+)/s);\nif (contactMatch) {\n  contactPerson = contactMatch[1].trim();\n}\n\n// å›å‚³çµæœ\nreturn [{\n  json: {\n    category: category,\n    companyName: companyName,\n    companyDetailUrl: companyUrl,\n    phone: phone || 'æœªæä¾›',\n    fax: fax || 'æœªæä¾›',\n    website: website || 'æœªæä¾›',\n    email: email || 'æœªæä¾›',\n    contactPerson: contactPerson || 'æœªæä¾›'\n  }\n}];"
      },
      "id": "daf3d11e-643f-4f7b-8103-9ab9f98ddbfe",
      "name": "6ï¸âƒ£ è§£æè©³ç´°è³‡æ–™",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        384,
        5712
      ]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 368568889,
          "mode": "list",
          "cachedResultName": "è¢«å‹•å…ƒä»¶",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=368568889"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $('Get row(s) in sheet3').item.json.Company_Name }}",
            "email": "={{ $json.email }}",
            "web": "={{ $json.website }}",
            "telephone": "={{ $json.phone }}",
            "status(æœå°‹)": "ready",
            "çˆ¬å–time": "={{ $now }}"
          },
          "matchingColumns": [
            "Company_Name"
          ],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å¯„ä¿¡æ¬¡æ•¸",
              "displayName": "å¯„ä¿¡æ¬¡æ•¸",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        592,
        5712
      ],
      "id": "c882f9fe-84c5-4722-aabc-d45b4ad220d1",
      "name": "Append or update row in sheet1",
      "executeOnce": true,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        800,
        5712
      ],
      "id": "619ed7c5-7c32-49a8-ac45-d759ffbba035",
      "name": "Wait8",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "content": "è¢«å‹•å…ƒä»¶\n",
        "height": 880,
        "width": 2208,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -832,
        5200
      ],
      "typeVersion": 1,
      "id": "01090591-ec39-4ea7-b7ef-59eaa214ece0",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "url": "={{ $json[\"ç¶²ç«™(ä¾†æº)\"] }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text"
            }
          }
        }
      },
      "id": "272594c2-a1c4-4f15-b69b-728f0b9c1aea",
      "name": "åˆæˆæ¨¹è„‚",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        240,
        6624
      ]
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "name",
              "cssSelector": "div.text_area",
              "returnArray": true
            },
            {
              "key": "URL",
              "cssSelector": "div.directory_list a",
              "returnValue": "attribute",
              "attribute": "href",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        512,
        6624
      ],
      "id": "8e70427f-6b73-47d8-bed4-7fea9386e678",
      "name": "HTML6"
    },
    {
      "parameters": {
        "jsCode": "// å–å¾— HTML6 è¼¸å‡ºçš„ name é™£åˆ—\nconst items = $input.all().map(item => item.json.name).flat();\n\n// æª¢æŸ¥ items æ˜¯å¦æœ‰è³‡æ–™\nif (!items || items.length === 0) {\n  return [];\n}\n\n// å°‡æ¯ä¸€ç­†è³‡æ–™è½‰æˆ n8n å¯æ¥å—æ ¼å¼\nconst output = items.map(raw => {\n    return {\n        json: {\n            name: (raw.match(/^.+å…¬å¸/) || [\"\"])[0],\n            tel: (raw.match(/TEL:\\s*([^\\n]+)/) || [\"\", \"\"])[1],\n            fax: (raw.match(/FAX:\\s*([^\\n]+)/) || [\"\", \"\"])[1],\n            address: (raw.match(/åœ°å€:\\s*([^\\n]+)/) || [\"\", \"\"])[1],\n            website: (raw.match(/https?:\\/\\/[^\\s\\[]+/) || [\"\"])[0],\n            email: (raw.match(/E-mail:\\s*([^\\n]+)/) || [\"\", \"\"])[1]\n        }\n    };\n});\n\nreturn output; // âœ… ä¸€å®šè¦ return é™£åˆ—\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        720,
        6624
      ],
      "id": "02652d1a-dc69-4bed-8fe2-eb77647c877b",
      "name": "Code in JavaScript5"
    },
    {
      "parameters": {
        "functionCode": "const pages = [];\nfor (let i = 1; i <= 5; i++) {\n  pages.push({ page: i });\n}\nreturn pages;"
      },
      "id": "3e4f85c9-f5fe-4b7e-9fab-ec75146049eb",
      "name": "Start Pages",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -512,
        6208
      ]
    },
    {
      "parameters": {
        "requestMethod": "POST",
        "url": "http://www.taiwansra.org.tw/web/directory/directory.jsp",
        "responseFormat": "string",
        "options": {
          "useQueryString": false
        },
        "bodyParametersUi": {
          "parameter": [
            {
              "name": "npage",
              "value": "={{ $json.page }}"
            }
          ]
        },
        "headerParametersUi": {
          "parameter": [
            {
              "name": "Content-Type",
              "value": "application/x-www-form-urlencoded"
            }
          ]
        }
      },
      "id": "441097f6-079c-4275-a87d-55ec9c3a4ad3",
      "name": "Fetch Page",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        0,
        6240
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -304,
        6208
      ],
      "id": "09617a89-b800-48ff-b085-43c3f14ceb2b",
      "name": "Loop Over Items12"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me5",
      "typeVersion": 1,
      "position": [
        1456,
        6368
      ],
      "id": "0e3cde46-2313-4238-877b-4b774f41885c"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "name",
              "cssSelector": "div.directory_list a",
              "returnArray": true
            },
            {
              "key": "URL",
              "cssSelector": "div.directory_list a",
              "returnValue": "attribute",
              "attribute": "href",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        352,
        6256
      ],
      "id": "71b66a26-3feb-4c73-bb66-5239f9c8b0f2",
      "name": "HTML7"
    },
    {
      "parameters": {
        "jsCode": "// input json:\n// { name: [...], URL: [...] }\n\nconst names = items[0].json.name;\nconst urls = items[0].json.URL;\n\nconst output = names.map((n, i) => {\n  const url = urls[i] || \"\";\n  const cp_no = url.match(/cp_no=([A-Z0-9]+)/)?.[1] || \"\";\n  return {\n    name: n.trim(),\n    cp_no: cp_no,\n    url: url\n  };\n});\n\nreturn output.map(o => ({ json: o }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        544,
        6272
      ],
      "id": "a30f7786-9c75-4072-841d-06d5022f2566",
      "name": "Code in JavaScript7"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1218919114,
          "mode": "list",
          "cachedResultName": "åˆæˆæ¨¹è„‚",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1218919114"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.name }}",
            "ç¶²ç«™(ä¾†æº)": "=http://www.taiwansra.org.tw/web/directory/directory_in.jsp?cp_no={{ $json.cp_no }}",
            "status(æœå°‹)": "wait"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡æ¬¡æ•¸",
              "displayName": "å¯„ä¿¡æ¬¡æ•¸",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        928,
        6256
      ],
      "id": "b66f6645-7da2-4dd8-b6af-44363921465f",
      "name": "Append row in sheet9",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1120,
        6320
      ],
      "id": "8cfaa989-4432-4f77-b8e1-c71238a2a222",
      "name": "Wait9",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1218919114,
          "mode": "list",
          "cachedResultName": "åˆæˆæ¨¹è„‚",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1218919114"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "status(æœå°‹)",
              "lookupValue": "wait"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -256,
        6624
      ],
      "id": "6aefbe3b-4a1f-4a20-b3e8-cb4385c470ee",
      "name": "Get row(s) in sheet4",
      "executeOnce": true,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -48,
        6624
      ],
      "id": "966e0e6c-7b89-4420-9006-9c6268307c88",
      "name": "Loop Over Items13"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me6",
      "typeVersion": 1,
      "position": [
        1504,
        6624
      ],
      "id": "2ca3eb27-fae9-4f56-a4f3-eaaa4422429f"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1218919114,
          "mode": "list",
          "cachedResultName": "åˆæˆæ¨¹è„‚",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1218919114"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $('Loop Over Items13').item.json.Company_Name }}",
            "email": "={{ $json.email }}",
            "web": "={{ $json.website }}",
            "åœ°å€": "={{ $json.address }}",
            "telephone": "={{ $json.tel }}",
            "status(æœå°‹)": "ready",
            "çˆ¬å–time": "={{ $now }}"
          },
          "matchingColumns": [
            "Company_Name"
          ],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å¯„ä¿¡æ¬¡æ•¸",
              "displayName": "å¯„ä¿¡æ¬¡æ•¸",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1088,
        6624
      ],
      "id": "5b77acfb-c4bc-4034-873d-282221f67541",
      "name": "Append or update row in sheet2",
      "executeOnce": true,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1296,
        6624
      ],
      "id": "e387873f-4ebf-44ec-a2b8-fa76d3bbcb45",
      "name": "Wait10",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {
        "content": "åˆæˆæ¨¹è„‚",
        "height": 704,
        "width": 2256
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -560,
        6160
      ],
      "typeVersion": 1,
      "id": "1d5238a7-08f0-4ada-a617-559b7722dc87",
      "name": "Sticky Note10"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "member",
              "cssSelector": "div.s-item-box h6",
              "returnArray": true
            },
            {
              "key": "url",
              "cssSelector": ".p-supplier-box a",
              "returnValue": "attribute",
              "attribute": "href",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        160,
        6976
      ],
      "id": "ef27f3e0-e62e-406c-8213-f727a753cbb0",
      "name": "HTML8"
    },
    {
      "parameters": {
        "fieldToSplitOut": "member,url",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        368,
        6976
      ],
      "id": "8dbd428d-5a66-4aa2-8557-c10122569f05",
      "name": "Split Out7"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1471421936,
          "mode": "list",
          "cachedResultName": "äººé€ çº–ç¶­",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1471421936"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $json.member }}",
            "status(æœå°‹)": "wait",
            "ç¶²ç«™(ä¾†æº)": "=https://www.tmmfsupplier.com.tw/{{ $json.url }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡æ¬¡æ•¸",
              "displayName": "å¯„ä¿¡æ¬¡æ•¸",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        576,
        6976
      ],
      "id": "51129ef9-18d9-412a-9e72-8d46955f798f",
      "name": "Append row in sheet8",
      "executeOnce": false,
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        496,
        7200
      ],
      "id": "836a7412-6d1c-41b5-96f7-4b75aec5c39a",
      "name": "Loop Over Items14"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me7",
      "typeVersion": 1,
      "position": [
        1536,
        7248
      ],
      "id": "9f1a64cc-cf8e-4a5d-bc43-d66157337d53"
    },
    {
      "parameters": {
        "url": "={{ $json[\"ç¶²ç«™(ä¾†æº)\"] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        720,
        7216
      ],
      "id": "58fc435f-3589-497f-a2ad-0c58f5e77a56",
      "name": "HTTP Request4"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1471421936,
          "mode": "list",
          "cachedResultName": "äººé€ çº–ç¶­",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1471421936"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "status(æœå°‹)",
              "lookupValue": "wait"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        176,
        7200
      ],
      "id": "f0b850a7-7931-4e4c-8aad-5b25befeafb9",
      "name": "Get row(s) in sheet5",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "tele",
              "cssSelector": "p.info-phone-icon"
            },
            {
              "key": "email",
              "cssSelector": "p.info-email-icon"
            },
            {
              "key": "companyurl",
              "cssSelector": "p.info-website-icon"
            },
            {
              "key": "address",
              "cssSelector": "p.info-add-icon"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        928,
        7216
      ],
      "id": "6c11bc65-b25a-4eb8-a0c5-5d4aa2d5f3f7",
      "name": "HTML9"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo",
          "mode": "list",
          "cachedResultName": "é–‹ç™¼ä¿¡",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1471421936,
          "mode": "list",
          "cachedResultName": "äººé€ çº–ç¶­",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Dnil8zdjdr1dfY6yhzxvNird-z50Bu5ldufgmMvXwlo/edit#gid=1471421936"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Company_Name": "={{ $('Loop Over Items14').item.json.Company_Name }}",
            "status(æœå°‹)": "ready",
            "çˆ¬å–time": "={{ $now }}",
            "telephone": "={{ $json.tele }}",
            "åœ°å€": "={{ $json.address }}",
            "web": "={{ $json.companyurl }}",
            "email": "={{ $json.email }}"
          },
          "matchingColumns": [
            "Company_Name"
          ],
          "schema": [
            {
              "id": "Company_Name",
              "displayName": "Company_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Registration_No",
              "displayName": "Registration_No",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç”Ÿç”¢ä¸­",
              "displayName": "ç”Ÿç”¢ä¸­",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "email",
              "displayName": "email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "web",
              "displayName": "web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "åœ°å€",
              "displayName": "åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "telephone",
              "displayName": "telephone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "status(æœå°‹)",
              "displayName": "status(æœå°‹)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å·¥å» ç™»è¨˜",
              "displayName": "å·¥å» ç™»è¨˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çˆ¬å–time",
              "displayName": "çˆ¬å–time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å¯„ä¿¡time",
              "displayName": "å¯„ä¿¡time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ç¶²ç«™(ä¾†æº)",
              "displayName": "ç¶²ç«™(ä¾†æº)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å¯„ä¿¡æ¬¡æ•¸",
              "displayName": "å¯„ä¿¡æ¬¡æ•¸",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1136,
        7216
      ],
      "id": "3d79d14d-3e71-49bb-b440-f61908875318",
      "name": "Append or update row in sheet3",
      "credentials": "[REMOVED]"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1312,
        7232
      ],
      "id": "3a2d2a5c-e1c6-4362-812b-208d37c96be6",
      "name": "Wait11",
      "webhookId": "[REMOVED]"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -112,
        7216
      ],
      "id": "a021c0c5-b801-40b1-b1bd-0d8d3dc133ea",
      "name": "When clicking â€˜Execute workflowâ€™"
    },
    {
      "parameters": {
        "url": "https://www.tmmfsupplier.com.tw/tw/product/category",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -48,
        6976
      ],
      "id": "54efa843-17ff-4a1f-bfe3-48ccd7873e6b",
      "name": "äººé€ å¡‘è† "
    },
    {
      "parameters": {
        "content": "äººé€ å¡‘è† ",
        "height": 544,
        "width": 2144,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -368,
        6944
      ],
      "typeVersion": 1,
      "id": "e2aaab26-49bf-4fe0-a9d0-4e6973e41bd8",
      "name": "Sticky Note11"
    }
  ],
  "pinData": {},
  "connections": {
    "è¨ˆç®—ç¸½é æ•¸åŠURL": {
      "main": [
        [
          {
            "node": "æ ¹æ“šé æ•¸URLæ“·å–è³‡æ–™",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ¹æ“šé æ•¸URLæ“·å–è³‡æ–™": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç¶“æ¿Ÿéƒ¨åœŸåŸç”¢æ¥­åœ’å€æœå‹™ä¸­å¿ƒ": {
      "main": [
        [
          {
            "node": "è¨ˆç®—ç¸½é æ•¸åŠURL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è§£æå„å·¥å» è³‡æ–™(æœ‰å·¥å» ç™»è¨˜çš„)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet1": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [
          {
            "node": "Line Messaging",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Website Verification Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "Update row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Website Verification Agent": {
      "main": [
        []
      ]
    },
    "Update row in sheet2": {
      "main": [
        [
          {
            "node": "Wait3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait3": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google search": {
      "main": [
        []
      ]
    },
    "Message a model in Perplexity": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "ä¿®æ”¹è¡Œæ¥­åˆ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "é‡è¤‡çš„",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "ç™¼é€å›æ‡‰çµ¦ LINE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å›å ±çµ¦ GAS": {
      "main": [
        []
      ]
    },
    "é‡è¤‡çš„": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æå„å·¥å» è³‡æ–™(æœ‰å·¥å» ç™»è¨˜çš„)": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger1": {
      "main": [
        []
      ]
    },
    "å…¬æœƒ - æŠ“å–é¦–é  (GET)": {
      "main": [
        [
          {
            "node": "è¨ˆç®—ç¸½é æ•¸åŠURL2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å…¬æœƒ - æŠ“å–æ‰€æœ‰é é¢ (GET + UA)": {
      "main": [
        [
          {
            "node": "HTML - æå–å¤šé åˆ—è¡¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML - æå–å¤šé åˆ—è¡¨": {
      "main": [
        [
          {
            "node": "Split Out2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ†æ - åˆ†æ‹†èˆ‡æ¸…ç†": {
      "main": [
        [
          {
            "node": "å…¬æœƒ - æŠ“å– Email é ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å…¬æœƒ - æŠ“å– Email é ": {
      "main": [
        [
          {
            "node": "Code - æå–ä¸¦æ¸…ç† Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨ˆç®—ç¸½é æ•¸åŠURL2": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items5": {
      "main": [
        [],
        [
          {
            "node": "å…¬æœƒ - æŠ“å–æ‰€æœ‰é é¢ (GET + UA)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet2": {
      "main": [
        []
      ]
    },
    "Split Out2": {
      "main": [
        [
          {
            "node": "Append row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å°ç£å¡‘è† å…¬æœƒ": {
      "main": [
        [
          {
            "node": "HTML2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¿®æ”¹è¡Œæ¥­åˆ¥": {
      "main": [
        [
          {
            "node": "ç¶“æ¿Ÿéƒ¨åœŸåŸç”¢æ¥­åœ’å€æœå‹™ä¸­å¿ƒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML2": {
      "main": [
        [
          {
            "node": "Split Out5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML1": {
      "main": [
        [
          {
            "node": "Split Out4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out4": {
      "main": [
        [
          {
            "node": "Append row in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out5": {
      "main": [
        [
          {
            "node": "Loop Over Items9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items9": {
      "main": [
        [],
        [
          {
            "node": "å°ç£å¡‘è† å…¬æœƒ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å°ç£å¡‘è† å…¬æœƒ1": {
      "main": [
        [
          {
            "node": "HTML1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait5": {
      "main": [
        [
          {
            "node": "Update row in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet3": {
      "main": [
        [
          {
            "node": "Loop Over Items9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet3": {
      "main": [
        [
          {
            "node": "Wait5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¨¡å…·å·¥æ¥­å…¬æœƒ": {
      "main": [
        [
          {
            "node": "Code in JavaScript6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å»ºç«‹é ç¢¼åˆ—è¡¨1": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript6": {
      "main": [
        [
          {
            "node": "Append row in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items6": {
      "main": [
        [],
        [
          {
            "node": "æ¨¡å…·å·¥æ¥­å…¬æœƒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me2": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet4": {
      "main": [
        [
          {
            "node": "Wait4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait4": {
      "main": [
        [
          {
            "node": "Replace Me2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Append row in sheet5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å»ºç«‹é ç¢¼åˆ—è¡¨2": {
      "main": [
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet5": {
      "main": [
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items7": {
      "main": [
        [],
        [
          {
            "node": "çµ²ç¹”å…¬æœƒ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "çµ²ç¹”å…¬æœƒ1": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å»ºç«‹é ç¢¼åˆ—è¡¨": {
      "main": [
        [
          {
            "node": "å…¬æœƒ - æŠ“å–é¦–é  (GET)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "å…ˆè§£ç¢¼(å› ç‚ºæœƒæœ‰äº‚ç¢¼)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML3": {
      "main": [
        [
          {
            "node": "Split Out3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out3": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [],
        [
          {
            "node": "è™•ç†nç­†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è™•ç†nç­†": {
      "main": [
        [
          {
            "node": "Append or update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append or update row in sheet": {
      "main": [
        [
          {
            "node": "Update row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å…ˆè§£ç¢¼(å› ç‚ºæœƒæœ‰äº‚ç¢¼)": {
      "main": [
        [
          {
            "node": "HTML3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [],
        []
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Split Out6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out6": {
      "main": [
        [
          {
            "node": "HTML4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML4": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items4": {
      "main": [
        [],
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request3": {
      "main": [
        [
          {
            "node": "HTML5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML5": {
      "main": [
        [
          {
            "node": "Append row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TPCDé›»è·¯æ¿": {
      "main": [
        [
          {
            "node": "HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Step 1: åŸå§‹ç¢¼èˆ‡å±¬æ€§": {
      "main": [
        [
          {
            "node": "Step 2: æ³¨å…¥ ID åˆ° HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Step 2: æ³¨å…¥ ID åˆ° HTML": {
      "main": [
        [
          {
            "node": "Step 3: è§£æ ID èˆ‡å…§å®¹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Step 3: è§£æ ID èˆ‡å…§å®¹": {
      "main": [
        [
          {
            "node": "Step 4: æœ€çµ‚æ¸…æ´—2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é›»æ± å…¬æœƒ3": {
      "main": [
        [
          {
            "node": "Step 1: åŸå§‹ç¢¼èˆ‡å±¬æ€§",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Step 4: æœ€çµ‚æ¸…æ´—2": {
      "main": [
        [
          {
            "node": "Append row in sheet6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me3": {
      "main": [
        []
      ]
    },
    "Append row in sheet6": {
      "main": [
        [
          {
            "node": "Replace Me3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet2": {
      "main": [
        [
          {
            "node": "Loop Over Items10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items10": {
      "main": [
        [],
        [
          {
            "node": "é›»æ± å…¬æœƒ4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me4": {
      "main": [
        [
          {
            "node": "Loop Over Items10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é›»æ± å…¬æœƒ4": {
      "main": [
        [
          {
            "node": "Step 1: åŸå§‹ç¢¼èˆ‡å±¬æ€§1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Step 1: åŸå§‹ç¢¼èˆ‡å±¬æ€§1": {
      "main": [
        [
          {
            "node": "Update row in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet4": {
      "main": [
        [
          {
            "node": "Wait2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait2": {
      "main": [
        [
          {
            "node": "Replace Me4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet1": {
      "main": [
        [
          {
            "node": "Wait6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait6": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨­å®šæ‰€æœ‰ URL": {
      "main": [
        [
          {
            "node": "Loop Over Items8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æ HTML å–å¾—å…¬å¸": {
      "main": [
        [
          {
            "node": "Append row in sheet7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items8": {
      "main": [
        [],
        [
          {
            "node": "è¢«å‹•å…ƒä»¶ç¬¬ä¸€é ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet7": {
      "main": [
        [
          {
            "node": "Wait7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait7": {
      "main": [
        [
          {
            "node": "Loop Over Items8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¢«å‹•å…ƒä»¶ç¬¬ä¸€é ": {
      "main": [
        [
          {
            "node": "è§£æ HTML å–å¾—å…¬å¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet3": {
      "main": [
        [
          {
            "node": "Loop Over Items11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items11": {
      "main": [
        [],
        [
          {
            "node": "è¢«å‹•å…ƒä»¶ç¬¬äºŒé ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me1": {
      "main": [
        [
          {
            "node": "Loop Over Items11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¢«å‹•å…ƒä»¶ç¬¬äºŒé ": {
      "main": [
        [
          {
            "node": "6ï¸âƒ£ è§£æè©³ç´°è³‡æ–™",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "6ï¸âƒ£ è§£æè©³ç´°è³‡æ–™": {
      "main": [
        [
          {
            "node": "Append or update row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append or update row in sheet1": {
      "main": [
        [
          {
            "node": "Wait8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait8": {
      "main": [
        [
          {
            "node": "Replace Me1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆæˆæ¨¹è„‚": {
      "main": [
        [
          {
            "node": "HTML6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML6": {
      "main": [
        [
          {
            "node": "Code in JavaScript5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript5": {
      "main": [
        [
          {
            "node": "Append or update row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Start Pages": {
      "main": [
        [
          {
            "node": "Loop Over Items12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Page": {
      "main": [
        [
          {
            "node": "HTML7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items12": {
      "main": [
        [],
        [
          {
            "node": "Fetch Page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me5": {
      "main": [
        [
          {
            "node": "Loop Over Items12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML7": {
      "main": [
        [
          {
            "node": "Code in JavaScript7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript7": {
      "main": [
        [
          {
            "node": "Append row in sheet9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet9": {
      "main": [
        [
          {
            "node": "Wait9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait9": {
      "main": [
        [
          {
            "node": "Replace Me5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet4": {
      "main": [
        [
          {
            "node": "Loop Over Items13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items13": {
      "main": [
        [],
        [
          {
            "node": "åˆæˆæ¨¹è„‚",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me6": {
      "main": [
        [
          {
            "node": "Loop Over Items13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append or update row in sheet2": {
      "main": [
        [
          {
            "node": "Wait10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait10": {
      "main": [
        [
          {
            "node": "Replace Me6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML8": {
      "main": [
        [
          {
            "node": "Split Out7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out7": {
      "main": [
        [
          {
            "node": "Append row in sheet8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet8": {
      "main": [
        []
      ]
    },
    "Loop Over Items14": {
      "main": [
        [],
        [
          {
            "node": "HTTP Request4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me7": {
      "main": [
        [
          {
            "node": "Loop Over Items14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet5": {
      "main": [
        [
          {
            "node": "Loop Over Items14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request4": {
      "main": [
        [
          {
            "node": "HTML9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML9": {
      "main": [
        [
          {
            "node": "Append or update row in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append or update row in sheet3": {
      "main": [
        [
          {
            "node": "Wait11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait11": {
      "main": [
        [
          {
            "node": "Replace Me7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "äººé€ å¡‘è† ": {
      "main": [
        [
          {
            "node": "HTML8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "48aaedc0-2a3d-4468-99f8-2ba65128fa7a",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "5cb73612af9c3d99fb9474cf656425558c43c24de4951be223ad83a0b24b4e43"
  },
  "id": "6XSXYZhCWPAaNZQv",
  "tags": []
}